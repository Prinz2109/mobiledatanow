<canvas debug="true">
    <include href="icontree/library.lzx" />

    <resource name="folder_rsrc">
        <frame src="iconresources/blank.png" />
        <frame src="iconresources/folder_closed.png" />
        <frame src="iconresources/folder_open.png" />
        <frame src="iconresources/folder_music.png" />
        <frame src="iconresources/folder_pictures.png" />
        <frame src="iconresources/folder_video.png" />
        <frame src="iconresources/music_note.png" />
    </resource>

    <!-- To use icontreenode, extend it, and add a view with a 
         multi-frame resource attached, naming it icon, as shown
         below. -->
    <class name="filetreenode" extends="icontreenode">

        <attribute name="labelx" value="40" />

        <!-- Overwrite this method and specify what frame the icon
             should switch to.  -->
        <method name="updateIcon">
            var frameNum = 1;
            switch (this.iconstate) {
                case "musicfolder":
                    frameNum = this.open ? 3 : 4;
                break;
                case "musicnote":
                    frameNum = 7;
                break;
                case "openclosed":
                    frameNum = this.open ? 3 : 2;
                break;
                case "musicfolder":
                    frameNum = this.open ? 3 : 4;
                break;
                case "videofolder":
                    frameNum = this.open ? 3 : 6;
                break;
                case "picturesfolder":
                    frameNum = this.open ? 3 : 5;
                break;
            }
            if (this["icon"]) {
                this.icon.setResourceNumber(frameNum);
            }
        </method>

        <view name="icon" resource="folder_rsrc" 
              x="${parent.leafindent+19}" />
    </class>

    <dataset name="dsFlat">
        <root>
            <node name="My Documents" _iconstate="openclosed">
                <node name="My Music" _iconstate="musicfolder">
                    <node name="The Sound of Muisc" _iconstate="musicnote" />
                    <node name="Maria" _iconstate="musicnote" />
                    <node name="I have Confidence" _iconstate="musicnote" />
                    <node name="Do-Re-Mi" _iconstate="musicnote" />
                    <node name="My Favorite Things" _iconstate="musicnote" />
                </node>
                <node name="My Videos" _iconstate="videofolder">
                    <node name="The Sound of Music" _iconstate="blank" />
                    <node name="Batman" _iconstate="blank" />
                </node>
                <node name="My Pictures" _iconstate="picturesfolder">
                    <node name="2005 Holiday Snaps" _iconstate="picturesfolder">
                        <node name="Family at the beach" _iconstate="blank" />
                        <node name="Sunbathing" _iconstate="blank" />
                    </node>
                    <node name="Friends and Family" _iconstate="picturesfolder">
                        <node name="Grandma" _iconstate="blank" />
                        <node name="Grandpa" _iconstate="blank" />
                    </node>
                </node>
            </node>
        </root>
    </dataset>

    <window x="20" y="20" width="250" height="300"
            resizable="true">
      <view x="20" y="20" width="200" height="200" clip="true">
        <opttree id="main" datapath="dsFlat:/root"
                width="100%" height="100%"
                nodepath="node" nodeclass="filetreenode" showtreelines="false">
            
        </opttree>
        <scrollbar />
      </view>

    </window>

</canvas>
