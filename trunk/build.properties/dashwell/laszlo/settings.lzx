<?xml version="1.0" encoding="UTF-8" ?>
<library>
	<!-- The General Settings. -->
	<class name="generalSettings" width="${navsett_rightView.width - 1}" 
			height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect">
		<attribute name="currDB"/>
		<view width="${immediateparent.width}" height="${immediateparent.height}" >
			<view width="${immediateparent.width - 80}" 
				height="${immediateparent.height - 80}" x="40" y="40">
				<simplelayout axis="y" spacing="8"/>
				<!-- Server Location -->
				<text datapath="gui:/gui-labels/lbl-server-location/@label" resize="true" 
							fontstyle="bold"/>
				<view width="${immediateparent.width}">
					<simplelayout axis="x"/>
						<view >
							<radiogroup>
								<simplelayout axis="y" spacing="10"/>
								<radiobutton datapath="gui:/gui-labels/lbl-ip-address/@label" width="100"/>
								<radiobutton datapath="gui:/gui-labels/lbl-domain/@label" width="100"/>
							</radiogroup>
						</view>
						<view >
							<simplelayout axis="y" spacing="2"/>
							<edittext text="123.456.789.12" width="200"/>
							<edittext text="" width="200"/>
						</view>
				</view>
				<view height="20"/>
				<!-- Ports -->
				<text datapath="gui:/gui-labels/lbl-ports/@label" fontstyle="bold"/>
				<view >
					<simplelayout axis="x"/>
					<text text="HTTP:" width="100" valign="middle"/>
					<edittext text="8080" width="200"/>
				</view>
				<view>
					<simplelayout axis="x"/>
					<text text="HTPPS:" width="100" valign="middle"/>
					<edittext text="8080" width="200"/>
				</view>
			</view>
		</view>
	</class>
	
	<!-- DB Driver Settings. -->
	<class name="myMDNAccount" width="${navsett_rightView.width - 1}" 
			height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect">
    	
        <method name="clearMessage">
        	bodyView.errorView.txtError.setText('');
    	</method>
    	
		<view name="bodyView" width="${immediateparent.width - 80}" height="${immediateparent.height - 20}" x="40" y="20">	
			<!-- The input fields to the right. -->
			<simplelayout axis="y" spacing="2"/>
			<text datapath="gui:/gui-labels/tree-account/@label" fontstyle="bold" fgcolor="0x454545" width="${immediateparent.width}"/>
			<view height="5"/>
			<view name="installationRefView" width="${immediateparent.width}">
				<simplelayout axis="x" spacing="5"/>
				<text datapath="gui:/gui-labels/lbl-userlicense-installation-ref/@label" width="240" valign="middle" fgcolor="0x454545" />
				<text datapath="dbRegisteredEmail:/root/@installationRef" width="100"/>
			</view>
			<view height="5"/>
			<view name="nameView" width="${immediateparent.width}">
				<simplelayout axis="x" spacing="5"/>
				<text datapath="gui:/gui-labels/lbl-userlicense-id/@label" width="130" valign="middle" fgcolor="0x454545" />
				<edittext name="txtEmail" datapath="dbRegisteredEmail:/root/@registeredEmail" width="300"/>
			</view>

			<view width="430">
				<simplelayout axis="x" spacing="5"/>
				<view width="130"/>
				<view>
					<mdn_button datapath="gui:/gui-labels/btn-save/@label" width="80" x="220">
		    			<method event="onclick">
					    	Debug.write('save/upload.onclick');
							var emailAddress = classroot.bodyView.nameView.txtEmail.getText();
							var d = canvas.datasets.dbRegisteredEmail;
							d.setQueryParam("action", "changeEmailAddress");
							d.setQueryParam("masterId", emailAddress);
							d.doRequest();										
		    			</method>
						<hinttip tipid="GLOBALSETTINGS-dbdrivers-update-button-driver" />
					</mdn_button>	
				</view>					
			</view>
			<view height="10"/>
	        
			<view name="errorView" width="${immediateparent.width}">
				<simplelayout axis="x" spacing="5"/>
				<text width="130" />
				<text name="txtError" text="" fgcolor="red" fontstyle="bold" resize="true"/>
			</view>
	        
	        <view name="licencetext">
				<view x="0" y="0">
					<simplelayout axis="x" spacing="0" />
					<text fgcolor="0x454545" resize="true" fontstyle="bold">User Licenses</text>
				</view>
				<view y="15" resize="true">
					<simplelayout axis="y" spacing="0" />
					<view id="showPaidUsers"  datapath="userLicenses:/root/node" resize="true">
						<simplelayout axis="x" spacing="0" />
						<text fgcolor="0x454545" resize="true" text="$path{'@type'}"></text>
						<text fgcolor="0x454545" resize="true" text="$path{'@colon'}"></text>
						<text fgcolor="0x454545" resize="true" text="$path{'@quantity'}"></text>
						<text fgcolor="0x454545" resize="true" text="$path{'@userText'}"></text>
						<text fgcolor="0x454545" resize="true" text="$path{'@expiryText'}"></text>
						<text fgcolor="0x454545" resize="true" text="$path{'@expiry'}"></text>
						<text fgcolor="0x454545" resize="true" text="$path{'@expiryText2'}"></text>
					</view>
					<view id="showPublicGroup" datapath="userLicenses:/root" resize="true">
						<simplelayout axis="x" spacing="0" />
						<text fgcolor="0x454545" resize="true" datapath="gui:/gui-labels/lbl-public-message/@label"></text>
						<text fgcolor="0x454545" resize="true" text="$path{'@publicGroup'}">
							<method event="ontext">
						       <![CDATA[
						       var t=this.getText(); 
						       if (t == 'Trial')
						       {	
						       		var t2="<u>"+t+"</u>";
						       		this.setText(t2);
						       }
						      ]]>
						    </method>
					        <method event="onclick">
						       var t=this.getText(); 
						       Debug.write("click txt", t);
						       if (t.indexOf("Trial") >=0)
						       {
		                      		controller.displayMsgControles();	                      		
		                      		msgControles.clearData();
		                      		settingBox.setAttribute("goToSpecialView", true);
									settingBox.open();
								}					
					        </method>
						</text>
					</view>
				</view>
				<mdn_button datapath="gui:/gui-labels/lbl-update-license/@label" y="55">
					<method event="ontext">
				       <![CDATA[
				       var t=this.getText(); 
				       var t2="<u>"+t+"</u>";
				       this.setText(t2);
				      ]]>
				    </method>
			        <method event="onclick">
						var d = canvas.datasets.userLicenses;
						d.setQueryParam("action", "updateLicense");
						//d.setQueryParam("userName", loginUser.getText());
						//d.setQueryParam("masterId", masterId.getText());
						d.doRequest();
			        </method>
			    </mdn_button>
			</view>
			<view width="100%" height="100%">
				<text datapath="gui:/gui-labels/lbl-mdn-version/@label" fontsize="14" x="${parent.width - this.width}" y="${(parent.height - this.height) - parent.y}" font="tabsFont" fgcolor="0x454545" name="txt" resize="true" />
	        </view>
		</view>
		<!-- Gets the registered email. -->
		<datapointer xpath="dbRegisteredEmail:/root" rerunxpath="true"
								ondata="processData();" onerror="canvas.showError(this);"
								ontimeout="canvas.showTimeout();">
			<method name="processData">
				Debug.write("received dbRegisteredEmail return data");
				var errorMsg = this.getNodeAttribute('msg');
				var result = this.getNodeAttribute('result');
				var newEmail = this.getNodeAttribute('registeredEmail');
				Debug.write("result", result, errorMsg, newEmail);
				classroot.bodyView.nameView.txtEmail.setText(newEmail);
				classroot.bodyView.errorView.txtError.setText(errorMsg);
				
			</method>
		</datapointer>			
	</class>
	
	<!-- DB Driver Settings. -->
	<class name="dbDriverClass" width="${navsett_rightView.width - 1}" 
			height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect">
		<attribute name="currDB"/>
		<attribute name="reselectFile" type="boolean" value="false"/>
		<attribute name="txtFileName"/>
		<attribute name="txtOriginalFileName"/>
		
        <method name="clearData">
        	bodyView.nameView.txtDriverName.setText('');
        	bodyView.driverView.txtDriver.setText('');
        	bodyView.descView.txtDriverDescription.setText('');
        	bodyView.errorView.txtDriverError.setText('');
        	this.setAttribute("reselectFile", false);
    	</method>
    	
        <method name="clearMessage">
        	bodyView.errorView.txtDriverError.setText('');
    	</method>
    	
		<fileUpload id="driverFileUpload">
			<method name="onComplete" args="fr">
				<![CDATA[
					Debug.write("DB driver File Upload onComplete--------------");
					classroot.bodyView.progressBarView.fileProgressBar.setValue(100);
					classroot.bodyView.errorView.txtDriverError.setAttribute('text', 'Refreshing database driver definition list ...');
					// Need to reload the current driver file.
			    	var driverId= classroot.bodyView.nameView.txtDriverId.getText();
					var driverName = classroot.bodyView.nameView.txtDriverName.getText();
			    	var driver = classroot.bodyView.driverView.txtDriver.getText();
		    		var description = classroot.bodyView.descView.txtDriverDescription.getText();
					var currFileName =  classroot.txtFileName.getText();
					var urlFormat = classroot.bodyView.urlFormatView.txtUrlFormat.getText();
											
		    		if (driverId == -1){
			    		controller.addNewDriver(driverName, driver, urlFormat, description, currFileName);		
			    	}else{
			    		controller.saveDriver(driverId, driverName, driver, urlFormat, description, currFileName);
			    	}
				]]>
			</method>
	
			<method name="onProgress" args="fileRef, bytesLoaded, bytesTotal">
				<![CDATA[
					Debug.write("DB driver File Upload onProgress--------------", bytesLoaded, bytesTotal);
					classroot.bodyView.progressBarView.fileProgressBar.setValue(bytesLoaded * 100 / bytesTotal);
				]]>
			</method>
	
			<method name="onSelect" args="fileRef">
				<![CDATA[
					Debug.write("DB driver File Upload onSelect--------------", getName());
					Debug.write("current file name", classroot.txtFileName.getText(), getName(), classroot.reselectFile);
					classroot.txtFileName.setText(getName());
					classroot.setAttribute("reselectFile", true);
					Debug.write("current file name", classroot.txtFileName.getText(), getName(), classroot.reselectFile);					
				]]>
			</method>
			
			<method name="onUploadCompleteData" args="fr, data">
				<![CDATA[
					Debug.write("DB driver File Upload onUploadCompleteData--------------");
					classroot.bodyView.progressBarView.fileProgressBar.setValue(100);
					classroot.bodyView.errorView.txtDriverError.setAttribute('text', 'Refreshing database driver definition list ...');
				]]>
			</method>
		</fileUpload>
    	
		<view name="bodyView" width="${immediateparent.width - 80}" height="${immediateparent.height - 20}" x="40" y="20">	
			<!-- The input fields to the right. -->
			<simplelayout axis="y" spacing="2"/>
			<text datapath="dbDriver:/root/driver/@name" fontstyle="bold" fgcolor="0x454545" width="${immediateparent.width}"/>

			<view height="5"/>
			<view name="nameView" width="${immediateparent.width}">
				<simplelayout axis="x" spacing="5"/>
				<text datapath="gui:/gui-labels/lbl-name/@label" width="130" valign="middle" fgcolor="0x454545" />
				<edittext name="txtDriverName" datapath="dbDriver:/root/driver/@name" width="300"/>
				<text name="txtDriverId" datapath="dbDriver:/root/driver/@id" width="0" visible="false"/>
				<hinttip tipid="GLOBALSETTINGS-dbdrivers-datasources-name_of_driver" />
			</view>
			<view name="driverView" width="${immediateparent.width}">
				<simplelayout axis="x" spacing="5"/>
				<text datapath="gui:/gui-labels/lbl-driver-url/@label" width="130" valign="middle" fgcolor="0x454545" />
				<edittext name="txtDriver" datapath="dbDriver:/root/driver/@driver" width="300"/>
				<hinttip tipid="GLOBALSETTINGS-dbdrivers-url-of-driver" />
			</view>
			<view name="urlFormatView" width="${immediateparent.width}">
				<simplelayout axis="x" spacing="5"/>
				<text datapath="gui:/gui-labels/lbl-driver-url-format/@label" width="130" valign="middle" fgcolor="0x454545" />
				<edittext name="txtUrlFormat" datapath="dbDriver:/root/driver/@urlFormat" width="300"/>
				<hinttip tipid="GLOBALSETTINGS-dbdrivers-url-format-of-driver" />
			</view>
			<view name="descView" width="${immediateparent.width}">
				<simplelayout axis="x" spacing="5"/>
				<text datapath="gui:/gui-labels/lbl-description/@label" width="130" valign="middle" fgcolor="0x454545" />
				<edittext name="txtDriverDescription" datapath="dbDriver:/root/driver/@description" width="300"/>
				<hinttip tipid="GLOBALSETTINGS-dbdrivers-description-of-driver" />
			</view>
			<view width="${immediateparent.width}" height="25">
				<simplelayout axis="x" spacing="5"/>
				<text datapath="gui:/gui-labels/lbl-driver-file-location/@label" width="125" fgcolor="0x454545" /><!-- valign="middle" -->
				<hinttip tipid="GLOBALSETTINGS-dbdrivers-upload-of-driver" />
				<view>
					<simplelayout axis="x" spacing="0"/>
					<edittext datapath="dbDriver:/root/driver/@filename" width="270" enabled="false">
						<method event="oninit">
							classroot.setAttribute("txtFileName", this);
						</method>
					</edittext>
					<text datapath="dbDriver:/root/driver/@originalFilename" width="0" visible="false">
						<method event="oninit">
							classroot.setAttribute("txtOriginalFileName", this);
						</method>					
					</text>
					<mdn_button datapath="gui:/gui-labels/btn-browse/@label" width="30">
						<method event="onclick">
							<![CDATA[
								Debug.write('browse.onclick');
								classroot.bodyView.progressBarView.fileProgressBar.setValue(0);
								driverFileUpload.browse();
							]]>
						</method>
						<hinttip tipid="GLOBALSETTINGS-language-browse" />
					</mdn_button>
				</view>
			</view>
			<view width="430">
				<simplelayout axis="x" spacing="5"/>
				<view width="130"/>
				<view>
					<mdn_button datapath="gui:/gui-labels/btn-save/@label" width="80" x="220">
		    			<method event="onclick">
					    	Debug.write('save/upload.onclick');
							var driverId= classroot.bodyView.nameView.txtDriverId.getText();
					    	var driverName = classroot.bodyView.nameView.txtDriverName.getText();
					    	var theDriver = classroot.bodyView.driverView.txtDriver.getText();
					    	var theURLFormat = classroot.bodyView.urlFormatView.txtUrlFormat.getText();
							// 1. Check whether driver name and file is given.
							if (driverName == ''){
								classroot.bodyView.errorView.txtDriverError.setAttribute('text', "Driver name is missing.");
								return;
							} else if (theDriver == ''){
								classroot.bodyView.errorView.txtDriverError.setAttribute('text', "Driver is missing.");
								return;
							} else if (theURLFormat == ''){
								classroot.bodyView.errorView.txtDriverError.setAttribute('text', "URL Format is missing.");
								return;
							}
							var fileName = classroot.txtFileName.getText();
							//Debug.write("====================fileName================", fileName, txtFileName.getText());
							/*if (fileName == ''){
								classroot.bodyView.errorView.txtDriverError.setAttribute('text', "No driver file selected.");
								return;
							}*/							
					    	
							classroot.bodyView.errorView.txtDriverError.setAttribute('text', '');
							var directSave = true;
							if (fileName == undefined || fileName == "" || fileName == null){
								Debug.write("===========1 This is direct save of driver!!!");
								directSave = true;
							}else{
								if (driverId == -1 ||driverId == '-1'){
									Debug.write("===========1 Need to upload driver file first!!!");
									directSave = false;
								}else{
									var originalFileName = classroot.txtOriginalFileName.getText();
									var currFileName =  classroot.txtFileName.getText();
									if (originalFileName == currFileName){
										if (classroot.reselectFile == true){
											Debug.write("===========2 Need to upload driver file first!!!");
											directSave = false;
										}else{
											Debug.write("===========2 This is direct save of driver!!!");
											directSave = true;
										}
									}else{
										Debug.write("===========3 Need to upload driver file first!!!");
										directSave = false;
									}
								}
							}
							if (directSave == false){
								Debug.write("===========Need to upload driver file first!!!");
								classroot.bodyView.progressBarView.fileProgressBar.setVisible(true);
								classroot.bodyView.errorView.txtDriverError.setAttribute('text', "Submitting ...");
								// 2. Send driver file name. Further processing done in datapointer.
								controller.requestDriverFileUpload(driverId, driverName);	
							}else{
								Debug.write("===========This is direct save of driver!!!");
								//Direct Save
						    	var driver = classroot.bodyView.driverView.txtDriver.getText();
					    		var description = classroot.bodyView.descView.txtDriverDescription.getText();
								var urlFormat = classroot.bodyView.urlFormatView.txtUrlFormat.getText();
								
					    		if (driverId == -1){
						    		controller.addNewDriver(driverName, driver, urlFormat, description, fileName);		
						    	}else{
						    		controller.saveDriver(driverId, driverName, driver, urlFormat, description, fileName);
						    	}												
							}					    	
					    	classroot.setAttribute("reselectFile", false);		    				
		    			</method>
						<hinttip tipid="GLOBALSETTINGS-dbdrivers-update-button-driver" />
					</mdn_button>	
				</view>					
			</view>
			<view height="10"/>
	        <view name="progressBarView">
				<simplelayout axis="x" spacing="5"/>
				<view width="130" />
				<view name="fileProgressBar" width="300" height="24" bgcolor="#666666" visible="false">
					<view x="1" y="1" width="298" height="22" bgcolor="#FFFFFF"/>
					<view name="status" x="1" y="1" height="22" bgcolor="#BBBBFF"/>
					<text name="percent" x="5" y="3" fontstyle="bold" fgcolor="#6666FF"/>
					<method name="setValue" args="value">
						<![CDATA[
							status.setAttribute('width', value * 298 / 100);
							percent.setText(Math.round(value) + '%');
						]]>
					</method>
				</view>
			</view>
			<view name="errorView" width="${immediateparent.width}">
				<simplelayout axis="x" spacing="5"/>
				<text width="130" />
				<text name="txtDriverError" text="" fgcolor="red" fontstyle="bold" resize="true"/>
			</view>	        
	        
		</view>

		<!-- Deals with the language file upload request. -->
		<datapointer xpath="dbDriverFileUpload:/root" rerunxpath="true"
								ondata="processData();" onerror="canvas.showError(this);"
								ontimeout="canvas.showTimeout();">
			<method name="processData">
				var result = this.getNodeText();
				Debug.write("received driver fileUpload return data ", result);
				if (result == 'OK'){
					// Upload the file.
					Debug.write("driver upload url", driverFileUploadURL.getAttribute('src'));
					driverFileUpload.upload(driverFileUploadURL.getAttribute('src'));
					classroot.bodyView.errorView.txtDriverError.setAttribute('text', "Uploading file ...");
				} else {
					classroot.bodyView.errorView.txtDriverError.setAttribute('text', result);
				}
			</method>
		</datapointer>
				
	   <!-- Deals with the new connection result. -->
	   <datapointer xpath="dbDriverReq:/root" rerunxpath="true"
	    ondata="processData();" onerror="canvas.showError(this);"
	    ontimeout="canvas.showTimeout();">
	    <method name="processData">
	        Debug.write("received new driver data: " + this.serialize());
	        projectTabs.setAttribute("wasfromsave", true);
	        projectTabs.whereami.select(projectTabs.whereami.getAttribute("currselnode"));
	        var result = this.getNodeText();
	        Debug.write("inside the data pointer processData... t3", result);
	        var action = this.getNodeAttribute('action');
	        if (action == "addNewDriver" || action == "saveDriver"){
	        	classroot.bodyView.errorView.txtDriverError.setAttribute('text', result);
	        }	        
	        if (result == "OK"){
	        	controller.getNavSett();
	        	//controller.getDrivers();
	        	//Add one extra one to make sure the data reload
	        	//controller.getDrivers();
	        	controller.getNavSett();
	        }
	    </method>
	   </datapointer>
	</class>


	<!-- Language Settings. -->
	<class name="LanguageSetting" width="${navsett_rightView.width - 1}" 
			height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect">
			
		<attribute name="currLang"/>
		<attribute name="reselectFile" type="boolean" value="false"/>
		<attribute name="txtFileName"/>
		
		<method name="clearData">
			fileUploadError.setText("");
			fileProgressBar.setVisible(false);
			this.setAttribute("reselectFile", false);
		</method>
		
		<fileUpload id="myFileUpload">
			<method name="onComplete" args="fr">
				<![CDATA[
					Debug.write("my File Upload onComplete--------------");
					fileProgressBar.setValue(100);
					fileUploadError.setAttribute('text', 'Refreshing language definition list ...');
					// Need to reload the current language definition file.
					var langId = txtLanguageId.getText();
					var languageName = txtLanguageName.getText();
					var fileName = classroot.txtFileName.getText();
					var setAsDefault = comboDefaultLang.getValue();
					
					controller.saveLanguage(langId, languageName, fileName, setAsDefault);
				]]>
			</method>
	
			<method name="onProgress" args="fileRef, bytesLoaded, bytesTotal">
				<![CDATA[
					Debug.write("my File Upload onProgress--------------", bytesLoaded, bytesTotal);
					fileProgressBar.setValue(bytesLoaded * 100 / bytesTotal);
				]]>
			</method>
	
			<method name="onSelect" args="fileRef">
				<![CDATA[
					Debug.write("my File Upload onSelect--------------", getName());
					Debug.write("current file name", classroot.txtFileName.getText(), getName(), classroot.reselectFile);
					classroot.txtFileName.setText(getName());
					classroot.setAttribute("reselectFile", true);
					Debug.write("current file name", classroot.txtFileName.getText(), getName(), classroot.reselectFile);
					
				]]>
			</method>
			
			<method name="onUploadCompleteData" args="fr, data">
				<![CDATA[
					Debug.write("my File Upload onUploadCompleteData--------------");
					fileProgressBar.setValue(100);
					fileUploadError.setAttribute('text', 'Refreshing language definition list ...');
					// Need to reload the current language definition file.
					var currLanguage = controller.getAttribute('currLanguage');
					controller.setLanguage(currLanguage);
				]]>
			</method>
		</fileUpload>
		
		<view width="${immediateparent.width}" height="${immediateparent.height}" >
			<view width="${immediateparent.width - 80}" 
						height="${immediateparent.height -10}" x="40" y="10">
				<simplelayout axis="y" spacing="30"/>
		
				<!-- Upper part of input fields. -->
				<view width="${parent.width}" height="${parent.height}">
					<simplelayout axis="y" spacing="20"/>
					
					<!-- The input fields to the right. -->
					<view width="${parent.width}" >
						<simplelayout axis="y" spacing="2"/>
						<text id="newLangLabel" datapath="gui:/gui-labels/lbl-add-new-lang/@label" fontstyle="bold" fgcolor="0x454545" resize="true" visible="false"/>
						<view height="5"/>
						<text datapath="gui:/gui-labels/lbl-note-txt-languages/@label" fontstyle="italic" resize="true" fgcolor="0x454545" />
						<view height="5"/>
						<view width="${immediateparent.width}">
							<simplelayout axis="x" spacing="5"/>
							<text datapath="gui:/gui-labels/lbl-language/@label" width="115" fgcolor="0x454545" /><!-- valign="middle" -->
							<hinttip tipid="GLOBALSETTINGS-language-language" />
							<edittext id="txtLanguageName" datapath="langReq:/root/@name" width="200"/>
							<text id="txtLanguageId" datapath="langReq:/root/@id" width="0" visible="false">
								<method event="ontext">
									//new language
									Debug.write("txtLanguageId ondata", this.getText(), "###################");
									if (this.getText() == -1 || this.getText() == '-1'){
										comboDefaultLang.selectItem(0);
										newLangLabel.setVisible(true);
									}else{
										newLangLabel.setVisible(false);
									}
								</method>
								
							</text>
							
						</view>
						<view width="${immediateparent.width}" height="25">
							<simplelayout axis="x" spacing="5"/>
							<text datapath="gui:/gui-labels/lbl-xml-file-location/@label" width="115" fgcolor="0x454545" /><!-- valign="middle" -->
							<hinttip tipid="GLOBALSETTINGS-language-upload" />
							<view>
								<simplelayout axis="x" spacing="0"/>
								<edittext datapath="langReq:/root/@filename" width="170" enabled="false">
									<method event="oninit">
										classroot.setAttribute("txtFileName", this);
									</method>
								</edittext>
								<text id="txtOriginalFileName" datapath="langReq:/root/@originalFilename" width="0" visible="false"/>
								<mdn_button datapath="gui:/gui-labels/btn-browse/@label" width="30">
									<method event="onclick">
										<![CDATA[
											Debug.write('browse.onclick');
											fileProgressBar.setValue(0);
											myFileUpload.browse();
										]]>
									</method>
									<hinttip tipid="GLOBALSETTINGS-language-browse" />
								</mdn_button>
							</view>
						</view>
						<view width="${immediateparent.width}">
							<simplelayout axis="x" spacing="5"/>
							<text datapath="gui:/gui-labels/lbl-default-lang/@label" width="120" valign="middle" fgcolor="0x454545" />
				            <combobox id="comboDefaultLang" width="200" editable="false" shownitems="8"><!-- datapath="langReq:/root" -->
				                <textlistitem text="Set As Default" value="1" /><!-- selected="${$path{'@defaultLang'} == true}" -->
				                <textlistitem text=" " value="0" /><!-- selected="$path{'@defaultLang' == false}" -->	                
				            </combobox>
						</view>
						<view>
							<simplelayout axis="x" spacing="5"/>
							<view width="120" />
							<view width="200">
								<mdn_button id="btnUpload" datapath="gui:/gui-labels/btn-save/@label" align="right">
									<method event="onclick">
										<![CDATA[
											Debug.write('upload.onclick');
											fileUploadError.setAttribute('text', '');
											// 1. Check whether language name and file is given.
											var language = txtLanguageName.getText();//txtLanguageName.getAttribute('text');
											//Debug.write("====================languageName================", language, txtLanguageName.getText());
											if (language == ''){
												fileUploadError.setAttribute('text', "Language name is missing.");
												return;
											}
											var fileName = classroot.txtFileName.getText();//txtFileName.getAttribute('text');
											//Debug.write("====================fileName================", fileName, txtFileName.getText());
											if (fileName == ''){
												fileUploadError.setAttribute('text', "No language definition file selected.");
												return;
											}
											var langId = txtLanguageId.getText();
											var directSave = true;
											if (langId == -1 ||langId == '-1'){
												directSave = false;
											}else{
												var originalFileName = txtOriginalFileName.getText();
												var currFileName =  classroot.txtFileName.getText();
												if (originalFileName == currFileName){
													if (classroot.reselectFile == true){
														directSave = false;
													}else{
														directSave = true;
													}
												}else{
													directSave = false;
												}
											}
											if (directSave == false){
												Debug.write("===========Need to upload language file first!!!");
												fileProgressBar.setVisible(true);
												fileUploadError.setAttribute('text', "Submitting ...");
												// 2. Send language name. Further processing done in datapointer.
												controller.requestFileUpload(langId, language);	
											}else{
												Debug.write("===========This is direct save of language!!!");
												//Direct Save
												var setAsDefault = comboDefaultLang.getValue();
												
												controller.saveLanguage(langId, language, fileName, setAsDefault);												
											}		
											classroot.setAttribute("reselectFile", false);									
										]]>
									</method>
									<hinttip tipid="GLOBALSETTINGS-language-upload" />
								</mdn_button>
							</view>
						</view>
						<view height="10"/>
						<view>
							<simplelayout axis="x" spacing="5"/>
							<view width="120" />
							<view id="fileProgressBar" width="200" height="24" bgcolor="#666666" visible="false">
								<view x="1" y="1" width="198" height="22" bgcolor="#FFFFFF"/>
								<view name="status" x="1" y="1" height="22" bgcolor="#BBBBFF"/>
								<text name="percent" x="5" y="3" fontstyle="bold" fgcolor="#6666FF"/>
								<method name="setValue" args="value">
									<![CDATA[
										status.setAttribute('width', value * 198 / 100);
										percent.setText(Math.round(value) + '%');
									]]>
								</method>
							</view>
						</view>
						<view width="${immediateparent.width}">
							<simplelayout axis="x" spacing="5"/>
							<text width="100" />
							<text id="fileUploadError" text="" fgcolor="red" fontstyle="bold" resize="true"/>
						</view>
					</view>
				</view>
			</view>
		</view>
		
		<!-- Deals with the language file upload request. -->
		<datapointer xpath="dbFileUpload:/root" rerunxpath="true"
								ondata="processData();" onerror="canvas.showError(this);"
								ontimeout="canvas.showTimeout();">
			<method name="processData">
				var result = this.getNodeText();
				Debug.write("received fileUpload return data ", result);
				if (result == 'OK'){
					// Upload the file.
					Debug.write("upload url", fileUploadURL.getAttribute('src'));
					myFileUpload.upload(fileUploadURL.getAttribute('src'));
					fileUploadError.setAttribute('text', "Uploading file ...");
				} else {
					fileUploadError.setAttribute('text', result);
				}
			</method>
		</datapointer>

		<datapointer xpath="langReq:/root" rerunxpath="true"
				ondata="processData();" onerror="canvas.showError(this);"
				ontimeout="canvas.showTimeout();">
			<method name="processData">
				var result = this.getNodeText();
		        Debug.write("received langReq return data", result);
				var currLang = this.getNodeAttribute('name');
		        var defaultLang = this.getNodeAttribute('defaultLang');
				var action = this.getNodeAttribute('action');
				var detailAction = this.getNodeAttribute('detailAction');
				if (action == 'saveLanguage'){				
					Debug.write("===============save Language Result================");
					if (result == 'OK'){
						if (detailAction =='add'){
							fileUploadError.setAttribute('text', "Language successfully added.");
						}else if (detailAction =='update'){
							fileUploadError.setAttribute('text', "Language successfully updated.");
						}
						controller.getNavSett();
						//var setAsDefault = defaultLang.getValue();
						Debug.write("*********************setAsDefault", defaultLang);
						if (defaultLang == true || defaultLang == 'true'){
							Debug.write("---------------current language", currLang, " is default.---------------------------------------");
							//controller.setAttribute('currLanguage', currLang); 
							//var currLanguage = controller.getAttribute('currLanguage');
							controller.setLanguage(currLang);
						}					
						comboDefaultLang.selectItem((defaultLang == true || defaultLang == 'true') ? 1 : 0);				
					}else {
						fileUploadError.setAttribute('text', result);
					}
				}else if (action == 'getLanguage'){
					comboDefaultLang.selectItem((defaultLang == true || defaultLang == 'true') ? 1 : 0);
				}
			</method>
		</datapointer>
	</class>
	
	<!-- Deals with the new connection result. -->
   <datapointer xpath="imNew:/root" rerunxpath="true"
    ondata="processData();" onerror="canvas.showError(this);"
    ontimeout="canvas.showTimeout();">
    <method name="processData">
        Debug.write("received newImConn return data");
        var result = this.getNodeText();
        var action = this.getNodeAttribute('action');
        var result = this.getNodeAttribute('result');
        var isSuccess = this.getNodeAttribute('isSuccess');
        var connId = this.getNodeAttribute('connId');        
        var updateData = false;
        if (action == 'imNew'){
            txtError.setAttribute('text', result);
            Debug.write("inside the data pointer processData newIMConnection...");
            if (isSuccess == 'true'){//result == 'OK'
/*                var name = txtName.getText();
                var username = txtUserName.getText();
                var password = txtPass.getText();
                var type = cbxProvider.getText();                

           		var leaf = treeSett.getLeafForNode(apples_dp_id.p);
           		Debug.write(">>>>>>>leaf ", leaf);
           		var imParent = leaf.data;
           		Debug.write(">>>>>>>imParent ", imParent);
           		var imChilderen = imParent.childNodes;
            	var newChild = imChilderen[0].cloneNode();
			  	newChild.attributes.name = type + "-" + name;
			  	newChild.attributes.type = "im-conn";
			  	newChild.attributes.value = connId;
			  	newChild.attributes._iconstate = "im";
				Debug.write(">>>>>>>newChild ", newChild);
           		imParent.appendChild(newChild); */
           		
           		controller.getNavSett();
				//controller.getNavSett();
           		controller.getAndDisplayConn(connId);
           		
           		Debug.write("#################### Save All good!");
           		
           		//Refresh Behind Settings Box
           		projectTabs.setAttribute("wasfromsave", true); 
 				projectTabs.whereami.select(projectTabs.whereami.getAttribute("currselnode"));
            } else {
              //Debug.write("");
            }
            
        }
    </method>
   </datapointer>
   
   <datapointer xpath="imSave:/root" rerunxpath="true"
    ondata="processData();" onerror="canvas.showError(this);"
    ontimeout="canvas.showTimeout();">
    <method name="processData">
        Debug.write("received Save Im return data");
        var result = this.getNodeText();
        var result = this.getNodeAttribute('result');
        var connId = this.getNodeAttribute('connId');

        txtError2.setAttribute('text', result);
        if (result == 'OK'){
       		controller.getNavSett();
        }
    </method>
   </datapointer>	
	<!-- Deals with the connect/Disconnect result. -->
   <datapointer xpath="connDisConn:/root" rerunxpath="true"
    ondata="processData2();" onerror="canvas.showError(this);"
    ontimeout="canvas.showTimeout();">
    <method name="processData2">
        Debug.write("received connect/disconnect return data ");

        var action = this.getNodeAttribute('action');
        var result = this.getNodeAttribute('result');
        var updateData = false;
        if (action == 'connDisConn'){
            Debug.write("result ===>  " + result);
            if(result == 'OK'){
                var btnTxt = this.getNodeAttribute('btnText');
		        connBtn.setAttribute('text', btnTxt);
        	    updateData = true;
            }
	        txtError2.setAttribute('text', result);
        }
    </method>
   </datapointer>
	
	
	<!-- The Messaging settings. -->
   <class name="newIMm" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  
        
        <method name="clearDataFromNewIMConnPage">
			txtIMName.setText('');
          	txtUserName.setText('');
          	txtPass.setText('');
          	cbxProvider.clearSelection();
          	txtError.setText('');
    	</method>
        
    <view id="backView" width="300" height="${immediateparent.height - 80}" x="40" y="40" >
        <simplelayout axis="y" spacing="2"/>
        <view name="provider">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-im-type/@label" width="100" fgcolor="0x454545"></text>
            <hinttip tipid="GLOBALSETTINGS-im-provider" />
            <combobox id="cbxProvider" width="200" editable="false" shownitems="8">
                <textlistitem text="AIM" value="1"/>
                <textlistitem text="Google Talk" value="5"/>
                <!-- <textlistitem text="ICQ" value="2"/> 
                <textlistitem text="Jabber" value="6"/> -->
                <textlistitem text="MSN" value="4"/>
                <textlistitem text="Yahoo!" value="3"/>
            </combobox>
        </view>
        <view name="name">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-im-name/@label" width="100" fgcolor="0x454545"></text>
            <hinttip tipid="GLOBALSETTINGS-im-name" />
            <edittext id="txtIMName" width="200" text=""/>
        </view>
        <view name="username">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-im-id/@label" width="100" fgcolor="0x454545"></text>
            <hinttip tipid="GLOBALSETTINGS-im-id" />
            <edittext id="txtUserName" width="200" text=""/>
        </view>
        <view name="password">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-im-password/@label" width="100" fgcolor="0x454545"></text>
            <hinttip tipid="GLOBALSETTINGS-im-password" />
            <edittext id="txtPass" name="password" password="true" width="200" text="" />
        </view>
        
        <view align="right">
        <mdn_button datapath="gui:/gui-labels/btn-save/@label" width="70">
            <method event="onclick">
                var name = txtIMName.getText();
                var username = txtUserName.getText();
                var password = txtPass.getText();
                var type = cbxProvider.getValue();                
  		        var error = null;
    	        var params = new LzParam();
        	    params.addValue('action', 'imNew', true);
            	params.addValue('imname', name);
            	params.addValue('username', username);            	
                params.addValue('password', password);
	            params.addValue('type', type);
    	        imNew.setQueryString(params);
        	    imNew.doRequest();
            </method>
            <hinttip tipid="GLOBALSETTINGS-im-save" />
        </mdn_button>
       </view>
        <view height="10"/>
        <view name="errorView" align="center">
            <text id="txtError" text="" fgcolor="red" fontstyle="bold" resize="true"  width="250" height="60" multiline="true" />
        </view>
	</view>        
   </class>     
   <class name="viewImConn" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  
      <method name="clearData">
          	txtError2.setText('');
      </method>        
        
     <view id="backView2" width="300" height="${immediateparent.height - 80}" x="40" y="40" >
        <simplelayout axis="y" spacing="2"/>
        
        <view name="providerView1">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-im-type/@label" width="100"></text>
            <hinttip tipid="GLOBALSETTINGS-im-provider" />
            <text id="txtProvider" visible="false" width="200"  datapath="imView:/root/@type"/>
            <text id="txtstatus" visible="false" width="200"  datapath="imView:/root/@status"/> 
            <text id="txtImId" visible="false" width="200"  datapath="imView:/root/@id"/>            
            <combobox id="cbxProvider1" width="200" editable="false" datapath="imView:/root/@type" shownitems="8">
                <textlistitem text="AIM" value="1"/>
                <textlistitem text="Google Talk" value="5"/>
                <!-- <textlistitem text="ICQ" value="2"/> 
                <textlistitem text="Jabber" value="6"/> -->
                <textlistitem text="MSN" value="4"/>
                <textlistitem text="Yahoo!" value="3"/>
            </combobox>            
        </view>
        <view name="name1">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-im-name/@label" width="100"></text>
            <edittext id="txtName1" width="200" datapath="imView:/root/@name"/>
            <hinttip tipid="GLOBALSETTINGS-im-name" />
        </view>
        <view name="username1">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-im-id/@label" width="100"></text>
            <edittext id="txtUserName1" width="200" datapath="imView:/root/@username"/>
            <hinttip tipid="GLOBALSETTINGS-im-id" />
        </view>
        <view name="password1">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-im-password/@label" width="100"></text>
            <edittext id="txtPass1" width="200"  password="true" datapath="imView:/root/@password"/>
            <hinttip tipid="GLOBALSETTINGS-im-password" />
        </view>
<!--         <view name="statusDesc">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-im-status/@label" width="100"></text>
			<text id="txtStatusDesc" width="500"  datapath="imView:/root/@date"/>
			<hinttip tipid="GLOBALSETTINGS-im-status" />       
		</view> -->
        <view align="right">
        <!-- <mdn_button id="connBtn" datapath="imView:/root/@btnText" width="70">
            <method event="onclick">
				<![CDATA[
	                var name = txtName1.getText();
	                var username = txtUserName1.getText();
    	            var password = txtPass1.getText();
        	        var type = txtProvider.getText();  
	                var status = txtstatus.getText();
	                var id = txtImId.getText();
	                
    		        var params = new LzParam();
        		    params.addValue('action', 'connDisConn', true);
            		params.addValue('username', username);
            		params.addValue('name', name);
	                params.addValue('password', password);
		            params.addValue('type', type);
	    	        params.addValue('status', status);	            
	    	        params.addValue('id', id);
    	    	    connDisConn.setQueryString(params);
        	    	connDisConn.doRequest();
        	    ]]>
            </method>
            <hinttip tipid="GLOBALSETTINGS-im-connect" />
        	</mdn_button> -->
        	
        <mdn_button datapath="gui:/gui-labels/btn-save/@label" width="70">
            <method event="onclick">
                var name = txtName1.getText();
                var username = txtUserName1.getText();
   	            var password = txtPass1.getText();
       	        var type = cbxProvider1.getValue();//txtProvider.getText();  
                var status = txtstatus.getText();
                var id = txtImId.getText();
    	        var params = new LzParam();
        	    params.addValue('action', 'imNew', true);
            	params.addValue('imId', id);
            	params.addValue('imname', name);
            	params.addValue('username', username);            	
                params.addValue('password', password);
	            params.addValue('type', type);
    	        imSave.setQueryString(params);
        	    imSave.doRequest();
            </method>
            <hinttip tipid="GLOBALSETTINGS-im-save" />
        </mdn_button>        	
       </view>
        <view height="10"/>
        <view name="errorView2" >
            <text id="txtError2" text="" fgcolor="red" fontstyle="bold" resize="true"  width="400" height="60" multiline="true" />
        </view>
	</view>        
   </class>     
	
	<!-- Email	-->
	
   <datapointer xpath="dbSetsave:/root" rerunxpath="true"
    ondata="processData();" onerror="canvas.showError(this);"
    ontimeout="canvas.showTimeout();">
    <method name="processData">
        Debug.write("Received dbSetsave return data");
        projectTabs.whereami.select(projectTabs.whereami.getAttribute("currselnode"));
        var action = this.getNodeAttribute('action');
        var result = this.getNodeAttribute('result');
        var isSuccess = this.getNodeAttribute('isSuccess');
		
        if (action == 'saveEmailSetting'){
            var p = dbSetsave.getPointer();
            p.selectChild(1);
            var emailId = p.p.getAttr('emailId');
	        
	        txtErrorEmail.setAttribute('text', result);        
        	if(isSuccess == 'true'){
				controller.getNavSett();
	        }
        }else if (action == 'editEmailSetting'){
            txtErrorEmailEdit.setAttribute('text', result);
        	controller.getNavSett();
        }else if (action == 'connDisConnSms'){
	        txtErrorSms2.setText(result);
			
        }else if (action == 'saveSmsInfo'){
	        txtErrorSms.setText(result);
	        controller.getNavSett();
        }
        if (action == 'testMessaginResult'){
            txtErrorMsgQEdit.setAttribute('text', result);
            newMsg.newMsg.errorView.txtErrorMsgQN.setAttribute('text', result);
		}            
    </method>
   </datapointer>
	
	<!-- Deals with the Save result. -->
   <datapointer xpath="dbMsg:/root" rerunxpath="true"
    ondata="processData();" onerror="canvas.showError(this);"
    ontimeout="canvas.showTimeout();">
    <method name="processData">
        Debug.write("received dbMsg return data");
        var action = this.getNodeAttribute('action');
        var result = this.getNodeAttribute('result');

        if (action == 'saveEmailSetting'){//saveEmailSett
            var p = dbMsg.getPointer();
            p.selectChild(1);
            var emailId = p.p.getAttr('emailId');
        
            txtErrorEmail.setAttribute('text', result);
            
            /*var params = new LzParam();
        	params.addValue('action', 'displayEmailSett', true);
        	params.addValue('emailId', emailId);        	
		    dbMsg.setQueryString(params);
        	dbMsg.doRequest();
        	*/
        	controller.getNavSett();
        }else if (action == 'editEmailSetting'){
            txtErrorEmailEdit.setAttribute('text', result);
        	controller.getNavSett();        	
        }else if (action == 'connDisConnSms'){
	        txtErrorSms2.setText(result);
			
        }else if (action == 'saveSmsInfo'){
	        txtErrorSms.setText(result);
	        controller.getNavSett();
        }
        if (action == 'testMessaginResult'){
            txtErrorMsgQEdit.setAttribute('text', result);
            txtErrorMsgQ.setAttribute('text', result);
		}            
    </method>
   </datapointer>

   <class name="addMdnEmailView" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  

         <method name="clearData">
        	addressTxt.setText('');
        	
        	imapTxt.setText('');
        	imapUserTxt.setText('');
        	imapPasswordTxt.setText('');
        	imapPortTxt.setText('143');
        	imapEncTypeNew.selectItem(1);
        	
        	smtpHostTxt.setText('');
			smtpUsernameTxt.setText('');
			smtpPasswordTxt.setText('');        	
        	smtpPortTxt.setText('25');
        	smtpEncTypeNew.selectItem(1);
        	
          	txtErrorEmail.setText('');
    	</method>

    <view width="${immediateparent.width - 80}" height="${immediateparent.height - 80}" x="40" y="10" >
        <simplelayout axis="y" spacing="5"/>
        <view>
        	<simplelayout axis="y" />
	        <text datapath="gui:/gui-labels/lbl-incoming-info/@label" width="450" fontstyle="bold" fgcolor="0x454545" />
	        <view width="525" height="1" bgcolor="0xe3e3e3" />
	        <view width="10" height="5" />
        </view>
        <!-- <view>
			<ftcheckbox2 id="imapSSLCbx" labelXpath="gui:/gui-labels/lbl-ssl/@label"/>        
        </view> -->
        <view>
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-enc-type/@label" width="110" fgcolor="0x454545" />        
            <combobox id="imapEncTypeNew" width="70" editable="false" bgcolor="${canvas.bgcolor}" shownitems="8">
                 <textlistitem text="None" value="1" selected="true"/>
                 <textlistitem text="SSL" value="2"/>                 
                 <textlistitem text="TLS" value="3"/>                                  
                 <textlistitem text="Auto" value="4"/>                                                   
            </combobox>        
        </view>
        <view name="emailAddress">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-email-address/@label" width="110" fgcolor="0x454545"></text>
            <edittext id="addressTxt" width="200" text="" />
            <hinttip tipid="GLOBALSETTINGS-email-emailaddress" />
        </view>        
        <view name="imap">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-imap-host/@label" width="110" fgcolor="0x454545" />
            <edittext id="imapTxt" width="200" text="" />
            <hinttip tipid="GLOBALSETTINGS-email-imap" />
            <text text="" width="3"/>            
            <text datapath="gui:/gui-labels/lbl-port/@label" width="32" fgcolor="0x454545" />
            <edittext id="imapPortTxt" width="45" text="143" maxlength="4"/>
        </view>
        <view name="imapUser">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-imap-user/@label" width="110" fgcolor="0x454545"></text>
            <edittext id="imapUserTxt" width="200" text="" />
            <hinttip tipid="GLOBALSETTINGS-email-username" />
        </view>
        <view name="imapPassword">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-imap-password/@label" width="110" fgcolor="0x454545"></text>
            <edittext id="imapPasswordTxt" password="true" width="200" text="" />
            <hinttip tipid="GLOBALSETTINGS-email-password" />
        </view>
        <view>
        	<simplelayout axis="y" />
            <view width="10" height="5" />
            <text datapath="gui:/gui-labels/lbl-outgoing-info/@label" width="450" fontstyle="bold" fgcolor="0x454545" />
            <view width="525" height="1" bgcolor="0xe3e3e3" />
	        <view width="10" height="5" />
        </view>
        <!-- <view>
			<ftcheckbox2 id="smtpSSLCbx" labelXpath="gui:/gui-labels/lbl-ssl/@label"/>
        </view>        -->
        <view>
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-enc-type/@label" width="110" fgcolor="0x454545" />        
            <combobox id="smtpEncTypeNew" width="70" editable="false" bgcolor="${canvas.bgcolor}" shownitems="8">
                 <textlistitem text="None" value="1" selected="true"/>
                 <textlistitem text="SSL" value="2"/>                 
                 <textlistitem text="TLS" value="3"/>                                  
                 <textlistitem text="Auto" value="4"/>                                                   
            </combobox>        
        </view>        
        <view name="smtp">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-smtp-host/@label" width="110" fgcolor="0x454545"></text>
            <edittext id="smtpHostTxt" width="200" text="" />
            <hinttip tipid="GLOBALSETTINGS-email-smtp" />
            <text text="" width="3"/>
            <text datapath="gui:/gui-labels/lbl-port/@label" width="32" fgcolor="0x454545" />
            <edittext id="smtpPortTxt" width="45" text="25" maxlength="4"/>
        </view>
        <view name="smtpUser">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-smtp-username/@label" width="110" fgcolor="0x454545"></text>
            <edittext id="smtpUsernameTxt" width="200" text="" />
            <hinttip tipid="GLOBALSETTINGS-email-username" />
        </view> 
        <view name="smtpPassword">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-smtp-password/@label" width="110" fgcolor="0x454545"></text>
            <edittext id="smtpPasswordTxt" password="true" width="200" text="" />
            <hinttip tipid="GLOBALSETTINGS-email-password" />
        </view>

        <view>
        <mdn_button datapath="gui:/gui-labels/btn-save/@label" x="424" y="10">
            <method event="onclick">
				<![CDATA[
	                var imap = imapTxt.getText();
	                var imapPort = imapPortTxt.getText();
	                var imapUser = imapUserTxt.getText();
	                var imapPass = imapPasswordTxt.getText();
	                var address = addressTxt.getText();
	                //var imapSSL = imapSSLCbx.getAttribute('value');
	                var imapEncType = imapEncTypeNew.getAttribute('value');

	                var smtp = smtpHostTxt.getText();
	                var smtpPort = smtpPortTxt.getText();
	                var smtpUser = smtpUsernameTxt.getText();
	                var smtpPass = smtpPasswordTxt.getText();	 
	                //var smtpSSL = smtpSSLCbx.getAttribute('value');
	                var smtpEncType = smtpEncTypeNew.getAttribute('value');
	                
    		        var params = new LzParam();
        		    params.addValue('action', 'saveEmailSetting', true);
        		    params.addValue('state', 0);

            		params.addValue('address', address);
            		params.addValue('imapHost', imap);
            		params.addValue('imapUserName', imapUser);
            		params.addValue('imapPassword', imapPass);            		            		            		
            		params.addValue('imapPort', imapPort);            		
            		params.addValue('imapEncType', imapEncType);

            		params.addValue('smtpHost', smtp);
            		params.addValue('smtpUsername', smtpUser);
            		params.addValue('smtpPassword', smtpPass);
            		params.addValue('smtpPort', smtpPort);            		
            		params.addValue('smtpEncType', smtpEncType);

    	    	    dbSetsave.setQueryString(params);
        	    	dbSetsave.doRequest();
        	    ]]>
            </method>
            <hinttip tipid="GLOBALSETTINGS-email-save" />
        	</mdn_button>
       </view>
        <view height="10"/>
        <view name="errorViewEmail" align="center">
            <text id="txtErrorEmail" text="" fgcolor="red" fontstyle="bold" resize="true"  width="250" height="60" multiline="true" />
        </view>
	</view>        
   </class>     
	 
   <class name="editMdnEmailView" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  
   	<method name="clearData">
       txtErrorEmailEdit.setText('');
   	</method>
    <view width="310" height="${immediateparent.height - 80}" x="40" y="10" >
        <simplelayout axis="y" spacing="5"/>
        <view>
	        <text datapath="gui:/gui-labels/lbl-incoming-info/@label" width="450" fontstyle="bold"/>
        </view>
        <view>
        	<text datapath="dbEmail:/root/@imapEncTypes" visible="false">
	        	<method event="ondata">
		            var p = dbEmail.getPointer();
		            p.selectChild(1);
		            var imapEncTypeValue = p.p.getAttr('imapEncType');
		            var smtpEncTypeValue = p.p.getAttr('smtpEncType');        	
		            
		            imapEncType.selectItem(imapEncTypeValue);
		            smtpEncType.selectItem(smtpEncTypeValue);
    	    	</method>
        	</text>        
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-enc-type/@label" width="110"/>        
            <combobox id="imapEncType" width="70" editable="false" bgcolor="${canvas.bgcolor}" shownitems="8">
                 <textlistitem text="None" value="1"/>
                 <textlistitem text="SSL" value="2"/>                 
                 <textlistitem text="TLS" value="3"/>                                  
                 <textlistitem text="Auto" value="4"/>                                                   
            </combobox>        
        </view>                
        <view name="emailAddress">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-email-address/@label" width="110"></text>
            <edittext id="addressEditTxt" width="200" datapath="dbEmail:/root/@address"  />
            <hinttip tipid="GLOBALSETTINGS-email-emailaddress" />
        </view>        
        <view name="imap">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-imap-host/@label" width="110"></text>
            <edittext id="imapEditTxt" width="200" datapath="dbEmail:/root/@imapHost" />
            <hinttip tipid="GLOBALSETTINGS-email-imap" />
            <text text="" width="3"/>            
            <text datapath="gui:/gui-labels/lbl-port/@label" width="32" />
            <edittext id="imapPortEdit" width="45" datapath="dbEmail:/root/@imapPort" />            
        </view>
        <view name="imapUser">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-imap-user/@label" width="110"></text>
            <edittext id="imapUserEditTxt" width="200" datapath="dbEmail:/root/@imapUserName" />
            <hinttip tipid="GLOBALSETTINGS-email-username" />
        </view>
        <view name="imapPassword">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-imap-password/@label" width="110"></text>
            <edittext id="imapPasswordEditTxt" width="200" datapath="dbEmail:/root/@imapPassword" password="true"/>
            <hinttip tipid="GLOBALSETTINGS-email-password" />
        </view>
        <view>
            <text datapath="gui:/gui-labels/lbl-outgoing-info/@label" width="450" fontstyle="bold"/>
        </view>
        <view>
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-enc-type/@label" width="110"/>        
            <combobox id="smtpEncType" width="70" editable="false" bgcolor="${canvas.bgcolor}" shownitems="8">
                 <textlistitem text="None" value="1"/>
                 <textlistitem text="SSL" value="2"/>                 
                 <textlistitem text="TLS" value="3"/>                                  
                 <textlistitem text="Auto" value="4"/>                                                   
            </combobox>        
        </view>                        
        <view name="smtp">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-smtp-host/@label" width="110"></text>
            <edittext id="smtpHostEditTxt" width="200" datapath="dbEmail:/root/@smtpHost" />
            <hinttip tipid="GLOBALSETTINGS-email-smtp" />
            <text text="" width="3"/>
            <text datapath="gui:/gui-labels/lbl-port/@label" width="32" />
            <edittext id="smtpPortEdit" width="45" datapath="dbEmail:/root/@smtpPort" />            
        </view>
        <view name="smtpUser">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-smtp-username/@label" width="110"></text>
            <edittext id="smtpUsernameTxtEdit" width="200" datapath="dbEmail:/root/@smtpUsername" />
        </view>
        <view name="smtpPassword">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-smtp-password/@label" width="110"></text>
            <edittext id="smtpPasswordTxtEdit" password="true" width="200" datapath="dbEmail:/root/@smtpPassword" />
        </view>        
        <view align="right">
        <mdn_button datapath="gui:/gui-labels/btn-save/@label" >
            <method event="onclick">
				<![CDATA[
		            var p = dbEmail.getPointer();
		            p.selectChild(1);
		            var emailId = p.p.getAttr('emailId');
				
	                var imap = imapEditTxt.getText();
	                var imapPort = imapPortEdit.getText();
	                var imapUser = imapUserEditTxt.getText();
	                var imapPass = imapPasswordEditTxt.getText();
	                var address = addressEditTxt.getText();
					var imapEncTypeValue = imapEncType.getValue();

	                var smtp = smtpHostEditTxt.getText();
	                var smtpPort = smtpPortEdit.getText();
	                var smtpUser = smtpUsernameTxtEdit.getText();
	                var smtpPass = smtpPasswordTxtEdit.getText();	 
					var smtpEncTypeValue = smtpEncType.getValue();	                
	                	                	                
    		        var params = new LzParam();
        		    params.addValue('action', 'editEmailSetting', true);
        		    params.addValue('state', 1);        		    
            		
            		params.addValue('imapHost', imap);
            		params.addValue('imapPort', imapPort);
            		params.addValue('imapUserName', imapUser);
            		params.addValue('imapPassword', imapPass);            		            		            		
            		params.addValue('address', address);
            		params.addValue('imapEncType', imapEncTypeValue);            		
            		  
            		params.addValue('emailId', emailId);  

					params.addValue('smtpHost', smtp);
            		params.addValue('smtpUsername', smtpUser);
            		params.addValue('smtpPassword', smtpPass);
            		params.addValue('smtpPort', smtpPort);            		
            		params.addValue('smtpEncType', smtpEncTypeValue);            		            		
            							
    	    	    dbSetsave.setQueryString(params);
        	    	dbSetsave.doRequest();
        	    ]]>
            </method>
            <hinttip tipid="GLOBALSETTINGS-email-save" />
        	</mdn_button>
       </view>
        <view height="10"/>
        <view name="errorViewEmail" align="center">
            <text id="txtErrorEmailEdit" text="" fgcolor="red" fontstyle="bold" resize="true"  width="250" height="60" multiline="true" />
        </view>
	</view>        
   </class>     
	
	<!-- Address Book -->
   <datapointer xpath="dbEmail:/root" rerunxpath="true"
    ondata="processData();" onerror="canvas.showError(this);"
    ontimeout="canvas.showTimeout();">
    <method name="processData">
	<![CDATA[
        if(abGrid ==  null){
        	//Debug.write("***************************************************************");
        }
        Debug.write("received save Email setting return data ");
        
        var action = this.getNodeAttribute('action');
        var result = this.getNodeAttribute('result');

        var size = (this.getNodeAttribute('size') * 25) + 5;
		if(size<=5){
	        if(abGrid !=  null){
		    	abGrid.setVisible(false);
		    }
	    	abGridW.setVisible(false);
	    	
	    	size=0;
	    }else if(size<=30){
	        if(abGrid !=  null){
				abGrid.setVisible(true);
			}
			abGridW.setVisible(true);
	    	size = 80;
	    }else if(size > 300)
	    {
	    	size=300;
	        if(abGrid !=  null){
	        	abGrid.setVisible(true);
	        }
			abGridW.setVisible(true);
	    	
	    }
        if(abGrid !=  null){
	    	abGrid.setHeight(size);
	    }
	    abGridW.setHeight(size);
	    
        if(txtErrorAddressBook !=  null){
	        txtErrorAddressBook.setAttribute('text', result);
        }
        txtErrorAddressBookW.setAttribute('text', result);
     ]]>   
    </method>
   </datapointer>
	
   <class name="addressBookView" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  

        <method name="clearData">
        	emailAddressTxt.setText('');
        	descTxt.setText('');
          	txtErrorAddressBook.setText('');
    	</method>

    <view id="view1" width="310" height="${immediateparent.height - 80}" x="40" y="40" datapath="dbEmail:/root">
        <simplelayout axis="y" spacing="5"/>
        <view name="emailTitle">
            <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-email-address/@label" width="200"></text>
            <text datapath="gui:/gui-labels/lbl-description/@label" width="400"></text>
        </view>
        <view name="emailAddress">
            <simplelayout axis="x" spacing="2"/>
            <edittext id="emailAddressTxt" width="200" text="" />
            <edittext id="descTxt" width="400" text="" />
	        <mdn_button datapath="gui:/gui-labels/btn-add/@label" >
    	        <method event="onclick">
					<![CDATA[
	        	        var emailAddress = emailAddressTxt.getText();
	                	var desc = descTxt.getText();
	                
    			        var params = new LzParam();
        			    params.addValue('action', 'addAddressBook', true);
            			params.addValue('emailAddress', emailAddress);
            			params.addValue('desc', desc);

    		    	    dbEmail.setQueryString(params);
        		    	dbEmail.doRequest();
        		    ]]>
	            </method>
        	</mdn_button>
        	</view>
				<view id="gridView">
					<simplelayout axis="x"/>
    				<ftgrid id="abGrid" datapath="dbEmail:/root" >
					    <ftgridtextcolumn width="202" datapath="@email-address"> Email Address
					    </ftgridtextcolumn>
					    <ftgridtextcolumn width="402" datapath="@desc"> Description
					    </ftgridtextcolumn>
					</ftgrid>

			        <handler name="onblurintextfield" args="rowdp" reference="abGrid">
                        Debug.write(addressBookView.view1.datapath);
                        var point = dbEmail.getPointer();
                        point.selectChild(1);

		                var emailAddress = rowdp.getNodeAttribute("email-address");
		                var desc = rowdp.getNodeAttribute("desc");		                
		                var id = rowdp.getNodeAttribute("id");		                		                
		                
		    	        var params = new LzParam();
        			    params.addValue('action', 'editAddressBook', true);
            			params.addValue('id', id);
		            	params.addValue('emailAddress', emailAddress);            	
        		        params.addValue('desc', desc);
		    	        dbEmail.setQueryString(params);
        			    dbEmail.doRequest();
        			    Debug.write("end");
			        </handler>
				</view>
        
        <view height="10"/>
        <view name="errorView" align="center">
            <text id="txtErrorAddressBook" text="" fgcolor="red" fontstyle="bold" resize="true"  width="250" height="60" multiline="true" />
        </view>
	</view>        
   </class>     
	
	<!-- The Look & Feel settings. -->
	<class name="lookAndFeel" width="${navsett_rightView.width - 1}" 
			height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect">
		<attribute name="currDB"/>
		<view width="${immediateparent.width}" height="${immediateparent.height}" >
			<view width="${immediateparent.width - 80}" 
						height="${immediateparent.height - 80}" x="40" y="40">
				<simplelayout axis="x" spacing="5"/>
          <text><text datapath="gui:/gui-labels/lbl-select-style/@label" /></text>
          <combobox width="120" editable="false" shownitems="8">
              <method event="onselect">
                  var colorchoice = this.getValue();
                  canvas[colorchoice+'colors'].setAttribute("isdefault", true);
              </method>

              <textlistitem text="Silver" value="'silver'"/>
              <textlistitem text="Green" value="'green'"/>
              <textlistitem text="Blue" value="'blue'" selected="true"/>
              <textlistitem text="Gold" value="'gold'"/>
              <textlistitem text="White" value="'white'"/>
              <textlistitem text="Purple" value="'purple'"/>
              <!-- <textlistitem text="Yellow" value="'yellow'"/> -->
          </combobox>
          <hinttip tipid="GLOBALSETTINGS-look-feel" />
			</view>
		</view>
	</class>
	
	<!-- Mirror DB Settings. -->
	<class name="mirrorDB" width="${navsett_rightView.width - 1}" 
			height="${navSettUpperPart.height - navSettHeader.height - 1}" bgcolor="yellow">
		<attribute name="currDB"/>
		<view width="${immediateparent.width}" height="${immediateparent.height}" >
			<view width="${immediateparent.width - 80}" 
						height="${immediateparent.height - 10}" x="40" y="10">
				<simplelayout axis="y" spacing="30"/>
		
				<!-- Upper part of input fields. -->
				<view width="${parent.width}" height="${parent.height}">
					<simplelayout axis="y" spacing="10"/>
					
					<!-- Listing of drivers. -->
					<view width="${parent.width}" >
						<simplelayout axis="y" spacing="10"/>
						<list width="${parent.width}" bgcolor="white" height="150">
							<textlistitem text="Default Dashwell Mirror"/>
						</list>
						<view width="${parent.width}">
							<view align="center">
								<simplelayout axis="x" spacing="3" />
								<mdn_button datapath="gui:/gui-labels/btn-add/@label"/>
								<mdn_button datapath="gui:/gui-labels/btn-update/@label"/>
								<mdn_button datapath="gui:/gui-labels/btn-clear/@label"/>
								<mdn_button datapath="gui:/gui-labels/btn-delete/@label"/>
							</view>
						</view>
					</view>
					
					<!-- The input fields to the right. -->
					<view width="${parent.width}" >
						<simplelayout axis="y" spacing="2"/>
						<text datapath="gui:/gui-labels/lbl-properties/@label" fontstyle="bold" resize="true"/>
						<view height="5"/>
						<view width="${immediateparent.width}">
							<simplelayout axis="x" spacing="5"/>
							<text datapath="gui:/gui-labels/lbl-name/@label" width="100" valign="middle"/>
							<edittext text="Default Dashwell Mirror" width="200"/>
						</view>
						<view width="${immediateparent.width}">
							<simplelayout axis="x" spacing="5"/>
							<text datapath="gui:/gui-labels/lbl-description/@label" width="100" valign="middle"/>
							<edittext text="" width="200"/>
						</view>
						<view width="${immediateparent.width}">
							<simplelayout axis="x" spacing="5"/>
							<text datapath="gui:/gui-labels/lbl-driver/@label" width="100" valign="middle"/>
							<combobox width="200" editable="false" shownitems="8">
								<textlistitem text="JDBC / ODBC Driver"/>
								<textlistitem text="Oracle 10i Driver"/>
								<textlistitem text="Microsoft SQL Server 2003"/>
							</combobox>
						</view>
						<view width="${immediateparent.width}">
							<simplelayout axis="x" spacing="5"/>
							<text datapath="gui:/gui-labels/lbl-url/@label" width="100" valign="middle"/>
							<edittext text="" width="200"/>
						</view>
						<view width="${immediateparent.width}">
							<simplelayout axis="x" spacing="5"/>
							<text datapath="gui:/gui-labels/lbl-schema/@label" width="100" valign="middle"/>
							<edittext text="" width="200"/>
						</view>
						<view width="${immediateparent.width}">
							<simplelayout axis="x" spacing="5"/>
							<text datapath="gui:/gui-labels/lbl-username/@label" width="100" valign="middle"/>
							<edittext text="" width="200"/>
						</view>
						<view width="${immediateparent.width}">
							<simplelayout axis="x" spacing="5"/>
							<text datapath="gui:/gui-labels/lbl-password/@label" width="100" valign="middle"/>
							<edittext text="" width="200"/>
						</view>
					</view>
				</view>
			</view>
		</view>
	</class>
	
   <class name="viewSmsSett" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  
        <method name="clearData">
          	txtErrorSms.setText('');
    	</method>
    <view width="700" height="${immediateparent.height - 80}" x="40" y="40" >
        <simplelayout axis="y" spacing="10"/>
        <view>
            <text datapath="gui:/gui-labels/lbl-sms-info/@label"  width="300" height="30" fontstyle="bold" fgcolor="0x454545" />     
        </view>
        <view>
	        <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-sim-num/@label" width="150" fgcolor="0x454545" /><!-- +6421303707 -->
			<edittext id="simNumTxt" width="200" datapath="dbSetsave:/root/@simNum" >
				<method event="ondata">
		            var p = dbSetsave.getPointer();
		            p.selectChild(1);
		            var baudrateDb = p.p.getAttr('baudrate');          	
		            baudrateTxt.selectItem(baudrateDb);
				</method>
			</edittext>
			<hinttip tipid="GLOBALSETTINGS-sms-simphone-number" />
        </view>
        <view>
	        <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-comm-port/@label"  width="150" fgcolor="0x454545" /><!-- COM1 -->
			<edittext id="commTxt" width="200" datapath="dbSetsave:/root/@comm" />
			<hinttip tipid="GLOBALSETTINGS-sms-comport" />
        </view>
        <view>
	        <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-baudrate/@label" width="150" fgcolor="0x454545" /><!-- 9600 -->
			<hinttip tipid="GLOBALSETTINGS-sms-baudrate" />
            <datacombobox id="baudrateTxt" width="200" editable="false" bgcolor="${canvas.bgcolor}"
            	itemdatapath="dbSetsave:/root/baudratesNode" textdatapath='@name' valuedatapath='@name' selectfirst="false">      
            </datacombobox>
        </view>
        <!-- <view>
	        <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-modem-man/@label" width="150" />
			<edittext id="modemManTxt" width="200" datapath="dbSetsave:/root/@modemMan" />
			<hinttip tipid="GLOBALSETTINGS-sms-manufacturer" />
        </view>
        <view>
	        <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-modem-model/@label" width="150" />
			<edittext id="modemModelTxt" width="200" datapath="dbSetsave:/root/@modemModel" />
			<hinttip tipid="GLOBALSETTINGS-sms-model" />
        </view> -->
        
        <view> <!-- align="right"  -->
	        <mdn_button id="smsSave" text="save" width="70" x="280">
    	        <method event="onclick">
					var number = simNumTxt.getText();
					var comm = commTxt.getText();
					var baudrate = baudrateTxt.getValue();
					var modemMan = modemManTxt.getText();
					var modemModel = modemModelTxt.getText();																				
    		        
    		        var params = new LzParam();
        		    params.addValue('action', 'saveSmsInfo', true);
        		    params.addValue('number', number);
        		    params.addValue('comm', comm);        		    
        		    params.addValue('baudrate', baudrate);
        		    params.addValue('modemMan', modemMan);
        		    params.addValue('modemModel', modemModel);

    	    	    dbSetsave.setQueryString(params);
        	    	dbSetsave.doRequest();
        	    	
        	    	//controller.getNavSett();
	            </method>
	            <hinttip tipid="GLOBALSETTINGS-sms-save" />
        	</mdn_button>
       </view>
        <view height="10"/>
        <view name="errorViewSms">
            <text id="txtErrorSms" fgcolor="red" fontstyle="bold" resize="true"  width="300" height="60" multiline="true" />
        </view>
	</view>        
   </class>     	
   <class name="viewSmsConn" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  
        <method name="clearData">
          	txtErrorSms2.setText('');
    	</method>
    <view width="700" height="${immediateparent.height - 80}" x="40" y="40" >
        <simplelayout axis="y" spacing="10"/>
        <view>
            <text datapath="gui:/gui-labels/lbl-sms-info/@label"  width="300" height="30"  fontstyle="bold"/>
        </view>
        <view>
	        <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-sim-num/@label" width="150" /><!-- +6421303707 -->
			<text id="simNumTxt2" width="200" datapath="dbSetsave:/root/@simNum" />
			<hinttip tipid="GLOBALSETTINGS-sms-simphone-number" />
        </view>
        <view>
	        <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-comm-port/@label"  width="150" /><!-- COM1 -->
			<text id="comm2" width="200" datapath="dbSetsave:/root/@comm" />
			<hinttip tipid="GLOBALSETTINGS-sms-comport" />
        </view>
        <view>
	        <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-baudrate/@label" width="150" /><!-- 9600 -->
			<text id="baudrate2" width="200" datapath="dbSetsave:/root/@baudrate" />
			<hinttip tipid="GLOBALSETTINGS-sms-baudrate" />
        </view>
        <view>
	        <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-modem-man/@label" width="150" /><!-- Wavecom -->
			<text id="modemMan2" width="200" datapath="dbSetsave:/root/@modemMan"  visible="false"/>
			<hinttip tipid="GLOBALSETTINGS-sms-manufacturer" />
        </view>
        <view>
	        <simplelayout axis="x"/>
            <text datapath="gui:/gui-labels/lbl-modem-model/@label" width="150" /><!-- M1306B -->
			<text id="modemModel2" width="200" datapath="dbSetsave:/root/@modemModel" />
			<hinttip tipid="GLOBALSETTINGS-sms-model" />
        </view>
        
        <view> <!-- align="right"  -->
	        <mdn_button id="smsConn2" datapath="dbSetsave:/root/@smsBtnTxt" width="70">
    	        <method event="onclick">
					var number = simNumTxt2.getText();
					var comm = comm2.getText();
					var baudrate = baudrate2.getText();
					var modemMan = modemMan2.getText();
					var modemModel = modemModel2.getText();																				
    		        
    		        var params = new LzParam();
        		    params.addValue('action', 'connDisConnSms', true);
        		    params.addValue('number', number);
        		    params.addValue('comm', comm);        		    
        		    params.addValue('baudrate', baudrate);
        		    params.addValue('modemMan', modemMan);
        		    params.addValue('modemModel', modemModel);
    	        
    	    	    dbSetsave.setQueryString(params);
        	    	dbSetsave.doRequest();
	            </method>
	            <hinttip tipid="GLOBALSETTINGS-sms-connect" />
	        </mdn_button>
       </view>
        <view height="10"/>
        <view name="errorViewSms" align="center">
            <text id="txtErrorSms2" fgcolor="red" fontstyle="bold" resize="true"  width="250" height="60" multiline="true" />
        </view>
	</view>        
   </class> 
   
   <class name="viewConditionSeparator"  width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  
    <view width="${immediateparent.width - 20}" x="42" y="20" name="backView">
        <simplelayout axis="y" spacing="15"/>
        <view name="parentView1">
	        <simplelayout axis="y" spacing="2"/>
            <text datapath="gui:/gui-labels/lbl-separator-info/@label"  width="700" height="30"  fontstyle="bold" fgcolor="0x454545" />
			<text width="80" datapath="dbSep:/root/@separator" visible="false">
    		 <hinttip tipid="GLOBALSETTINGS-msg-separator-note" /> 
               	<method event="ondata">
		            var p3 = dbSep.getPointer();
		            Debug.write(p3);
		            p3.selectChild(1);
		            var separator = p3.p.getAttr('separator');
               	
		   			classroot.backView.parentView2.pView.view1.msgConSepN.selectItemAt( separator );
		   			classroot.backView.parentView2.pView.view1.msgConSepN.selectItem( separator );   		
		            
			    </method>
 		    </text>
        </view>
	    <view name="parentView2" >
         	<simplelayout axis="y" spacing="2"/>
     		<text datapath="gui:/gui-labels/lbl-condition-seperator/@label" width="150" fontstyle="bold" fgcolor="0x454545" />
     		  <hinttip tipid="GLOBALSETTINGS-msg-separator-note" /> 
			<view name="pView" height="100">
				<simplelayout axis="x" spacing="50"/>
				<view name="view1">
					<simplelayout axis="x" spacing="0"/>
					<radiogroup layout="axis: y; spacing:10"  name="msgConSepN" >
						<radiobutton datapath="gui:/gui-labels/lbl-space/@label" width="60" value="0"><hinttip tipid="GLOBALSETTINGS-msg-separator-space"/></radiobutton>
						<radiobutton datapath="gui:/gui-labels/lbl-comma/@label" width="65" value="1"><hinttip tipid="GLOBALSETTINGS-msg-separator-comma"/></radiobutton>
						<radiobutton datapath="gui:/gui-labels/lbl-semicolon/@label" width="85" value="2"><hinttip tipid="GLOBALSETTINGS-msg-separator-semicolon"/></radiobutton>
						<radiobutton datapath="gui:/gui-labels/lbl-other/@label" width="56" value="3"><hinttip tipid="GLOBALSETTINGS-msg-separator-other"/></radiobutton>
					</radiogroup>
					<method event="onselect" reference="msgConSepN">
						var sep = classroot.backView.parentView2.pView.view1.msgConSepN.getValue();
						if(sep != 3) {
							classroot.backView.parentView2.pView.view1.txtOtherMsgSepN.setAttribute('enabled', false);
							classroot.backView.parentView2.pView.view1.txtOtherMsgSepN.setAttribute('text', '');
						}else{
							classroot.backView.parentView2.pView.view1.txtOtherMsgSepN.setAttribute('enabled', true);
						}
					</method>
					<edittext name="txtOtherMsgSepN" width="40" datapath="dbSep:/root/@other" maxlength="1" x="0" y="77"/>
				</view>
				<view name="rightView">
					<simplelayout axis="y"/>
					<text datapath="gui:/gui-labels/lbl-separator-info-1/@label" width="300" multiline="true" fontstyle="bold" fgcolor="0x454545"/>		
					<text datapath="gui:/gui-labels/lbl-separator-info-2/@label"  width="300" height="300" multiline="true" fgcolor="0x454545" />
				</view>
			</view>	
	        <view align="right">
		        <mdn_button datapath="gui:/gui-labels/btn-save/@label" width="70">
		            <method event="onclick">
	       		        var seperator = classroot.backView.parentView2.pView.view1.msgConSepN.getValue(); 
	       		        var other = classroot.backView.parentView2.pView.view1.txtOtherMsgSepN.getText();
	       		        
		    	        var params = new LzParam();
		        	    params.addValue('action', 'saveMsgSeperator', true);
		            	params.addValue('seperator', seperator);
		            	params.addValue('other', other);
	
		    	        dbSep.setQueryString(params);
		        	    dbSep.doRequest();
		            </method>
		             <hinttip tipid="GLOBALSETTINGS-msg-separator-save" /> 
		        </mdn_button>
	       </view>					
		</view>
	</view>        
   </class>

   <class name="viewMsgControles"  width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  
        <method name="clearData">
          	contactBlockError.setText('');
    	</method>        
	    <view width="${immediateparent.width - 10}" height="${immediateparent.height - 10}" x="4" y="1" name="backView">
	        <simplelayout axis="y" spacing="2"/>
	        <!-- <view>
		        <text datapath="dbMsgControls:/root/@unlimited" visible="false">
	               	<method event="ondata">
			            var p = dbMsgControls.getPointer();
			            p.selectChild(1);
			            var unlimited = p.p.getAttr('unlimited');
			            if(unlimited == 'true'){
				            Debug.write("Unlimited public messages license");
				            infoLeft.setVisible(false);
				            //infoCounter.setVisible(false);
				            //infoCounter2.setVisible(false);
				        }
				    </method>	        
		        </text> 
	        </view>
	        <view id="infoLeft">
	        	<simplelayout axis="x" />
		        <text datapath="gui:/gui-labels/lbl-num-left-txt/@label" width="216" fgcolor="0x454545" />
		        <text datapath="gui:/gui-labels/lbl-num-email/@label" width="45" fontstyle="bold" fgcolor="0x454545" />
		        <text id="emailNum"  datapath="dbMsgControls:/root/@emailNumLeft" width="24"/>
		        <text datapath="gui:/gui-labels/lbl-num-im/@label" width="30" fontstyle="bold" fgcolor="0x454545" />
		        <text id="imNum" datapath="dbMsgControls:/root/@imNumLeft" width="24"/>
		        <text datapath="gui:/gui-labels/lbl-num-sms/@label" width="72" fontstyle="bold" fgcolor="0x454545" />
		        <text id="smsNum" datapath="dbMsgControls:/root/@smsNumLeft" width="24"/>	        	
			    <text datapath="gui:/gui-labels/lbl-num-smpp/@label" width="79" fontstyle="bold" fgcolor="0x454545" />
			    <text id="smppNum" datapath="dbMsgControls:/root/@smppNumLeft" width="24"/>			        		        
	        </view> -->
	        <view>
		        <simplelayout axis="y" spacing="4" />
				<view id="infoCounter">	        
		        	<simplelayout axis="x" />
			        <text datapath="gui:/gui-labels/lbl-num-txt/@label" width="216" fgcolor="0x454545" />
			        <text datapath="gui:/gui-labels/lbl-num-email/@label" width="45" fontstyle="bold" fgcolor="0x454545" />
			        <text id="emailNum"  datapath="dbMsgControls:/root/@emailNum" width="24"/>
			        <text datapath="gui:/gui-labels/lbl-num-im/@label" width="30" fontstyle="bold" fgcolor="0x454545" />
			        <text id="imNum" datapath="dbMsgControls:/root/@imNum" width="24"/>
			        <text datapath="gui:/gui-labels/lbl-num-sms/@label" width="72" fontstyle="bold" fgcolor="0x454545" />
			        <text id="smsNum" datapath="dbMsgControls:/root/@smsNum" width="24"/>
			        <text datapath="gui:/gui-labels/lbl-num-smpp/@label" width="79" fontstyle="bold" fgcolor="0x454545" />
			        <text id="smppNum" datapath="dbMsgControls:/root/@smppNum" width="24"/>			        
		        </view>
		        <view id="infoCounter2">
			        <simplelayout axis="y" spacing="6" />
			        <view width="525" height="1" bgcolor="0xe3e3e3" />
			        <text datapath="gui:/gui-labels/lbl-temp-txt/@label" width="220" fontstyle="bold" fgcolor="0x454545" />
		        </view>	        
	        </view>	        	        	        
	        <view>
	        	<simplelayout axis="x" />
		        <text datapath="gui:/gui-labels/lbl-max-msg-1/@label" width="200" fgcolor="0x454545" />
		        <edittext datapath="dbMsgControls:/root/@maxMsg" id="maxMsgTxt" width="50" maxlength="2"/>
		        <text datapath="gui:/gui-labels/lbl-max-msg-2/@label" width="150" fgcolor="0x454545" />
	        </view>
	        <view>
	        	<simplelayout axis="x"/>
		        <text datapath="gui:/gui-labels/lbl-for-period/@label" width="200" fgcolor="0x454545" />
		        <edittext datapath="dbMsgControls:/root/@period" id="forPeriodTxt" width="50" maxlength="2"/>
				<text datapath="gui:/gui-labels/lbl-minutes/@label" fgcolor="0x454545" />		        
	        </view>	        
	        <view>
	        	<simplelayout axis="x" />
		        <text datapath="gui:/gui-labels/lbl-cancel/@label" width="200" fgcolor="0x454545" />
		        <edittext datapath="dbMsgControls:/root/@cancel" id="cancelAfterTxt" width="50" maxlength="2"/>
		        <text datapath="gui:/gui-labels/lbl-minutes/@label" fgcolor="0x454545" />
	        </view>	        	        
	        <view>
	        	<simplelayout axis="x" />
		        <text datapath="gui:/gui-labels/lbl-send-reply/@label" width="200" fgcolor="0x454545" />
		        <edittext datapath="dbMsgControls:/root/@reply" id="blockReplyTxt" multiline="true" height="50" width="200"/>
	        </view>
	        <view>
	        	<simplelayout axis="x" spacing="2"/>
	        	<text text="" width="350"/>
				<mdn_button datapath="gui:/gui-labels/btn-save/@label" width="50">
    				<method event="onclick">		
		                var maxMsg = maxMsgTxt.getText();
		                var forPeriod = forPeriodTxt.getText();                
		                var cancelAfter = cancelAfterTxt.getText();                
		                var blockReply = blockReplyTxt.getText();        
		                
		                Debug.write("maxMsg: "+ maxMsg + ", forPeriod:"+ forPeriod 
		                + " ,cancelAfter:"+cancelAfter + " ,blockReply:" + blockReply );

    					// maxMsg forPeriod cancelAfter blockReply 
		    	        var params = new LzParam();
		        	    params.addValue('action', 'saveMsgControl', true);
		            	params.addValue('maxMsg', maxMsg);
			            params.addValue('forPeriod', forPeriod);
			            params.addValue('cancelAfter', cancelAfter);
			            params.addValue('blockReply', blockReply);
		    	        saveBlockContact.setQueryString(params);
		        	    saveBlockContact.doRequest();	    									    	 
    				</method>
				</mdn_button>										        	           
	        </view>    	        
	        <view>
		        <simplelayout axis="y" spacing="6" />
		        <view width="525" height="1" bgcolor="0xe3e3e3" />	        
		        <text datapath="gui:/gui-labels/lbl-block/@label" width="200" fontstyle="bold" fgcolor="0x454545" />
	        </view>
	        <view>
	        	<simplelayout axis="x" spacing="2"/>
	            <combobox id="cbxMessaginTypes" width="150" editable="false" shownitems="8">
	                <textlistitem text="Email" value="1" />
	                <textlistitem text="IM" value="2" />
	                <textlistitem text="SMS" value="3" />
	            </combobox>
		        <edittext text="" id="blockContactTxt" width="200"/>
				<mdn_button datapath="gui:/gui-labels/btn-add/@label" width="50">
	    			<method event="onclick">		
		                var contact = blockContactTxt.getText();
		                var type = cbxMessaginTypes.getValue();                
		    	        var params = new LzParam();
		        	    params.addValue('action', 'saveBlockContact', true);
		            	params.addValue('contact', contact);
			            params.addValue('type', type);
		    	        saveBlockContact.setQueryString(params);
		        	    saveBlockContact.doRequest();	    									    	
	    			</method>
				</mdn_button>										        
	        </view>	        	
	        <view>
		        <simplelayout axis="x" spacing="2"/>
	            <datacombobox id="cbxBlocksList" width="150" editable="false" bgcolor="${canvas.bgcolor}"
	            	itemdatapath="dbMsgControls:/root/block" textdatapath='@cbxName'  valuedatapath='@id'>
		        </datacombobox>
	           	<edittext id="editBlockTxt" width="200"/>
				<mdn_button datapath="gui:/gui-labels/btn-save/@label" width="50">
    				<method event="onclick">		
		                var contact = editBlockTxt.getText();
		                var id = cbxBlocksList.getValue();                
		    	        var params = new LzParam();
		        	    params.addValue('action', 'saveBlockContact', true);
		            	params.addValue('contact', contact);
			            params.addValue('id', id);
		    	        saveBlockContact.setQueryString(params);
		        	    saveBlockContact.doRequest();	    									    	
    				</method>
				</mdn_button>										        	           
	        </view>
	        <view>
   				<ftgrid id="blockGrid" height="110" datapath="dbMsgControls:/root" >
					<ftgridcolumn  width="150" rowdp="1">Type<text datapath="@type"/></ftgridcolumn>
				    <ftgridtextcolumn width="200" datapath="@contact" editable="false"> Contact </ftgridtextcolumn>				    
				</ftgrid>	        
		        <handler name="onfocusintextfield" args="rowdp" reference="blockGrid">
		        </handler>		        		        
	        </view>
	        <view>
	        	<text id="contactBlockError" text="" fgcolor="red" width="350" fontstyle="bold"/>
	        </view>    	        	        
	    </view>
    </class>    	
	<datapointer xpath="saveBlockContact:/root" rerunxpath="true"
								ondata="processData();" onerror="canvas.showError(this);"
								ontimeout="canvas.showTimeout();">
			<method name="processData">
				var result = this.getNodeText();
				contactBlockError.setAttribute('text', result);
				if (result == 'OK'){
				    var params = new LzParam();
		        	params.addValue('action', 'msgControls', true);
				    dbMsgControls.setQueryString(params);
		        	dbMsgControls.doRequest();				
				}
			</method>
	</datapointer>    
	
	<datapointer xpath="saveSearch:/root" rerunxpath="true"
								ondata="processData();" onerror="canvas.showError(this);"
								ontimeout="canvas.showTimeout();">
			<method name="processData">
				var result = this.getNodeText();
				msgKeywordSearchError.setAttribute('text', result);
			</method>
	</datapointer>    
 	<!-- <datapointer xpath="testSearch:/root" rerunxpath="true"
								ondata="processData();" onerror="canvas.showError(this);"
								ontimeout="canvas.showTimeout();">
			<method name="processData">
				var result = this.getNodeText();
				searchTermResult.setAttribute('text', result);
			</method>
	</datapointer>    	-->
   <class name="viewSearchMsg" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  
	    <view width="${immediateparent.width - 20}" height="${immediateparent.height - 10}" x="22" y="1" name="backView">
	        <method name="clearData">
	          	msgKeywordSearchError.setText('');
	    	</method>
	        <simplelayout axis="y" spacing="4"/>
	        <view>
	        	<simplelayout axis="x" spacing="2"/>
	        	<text datapath="gui:/gui-labels/lbl-search-term/@label" width="120" fgcolor="0x454545" />
	        	<edittext id="searchTerm" datapath="dbSearch:/root/@term" width="150"/>
				<mdn_button datapath="gui:/gui-labels/btn-edit/@label" width="50">
    				<method event="onclick">		
	    				var term = searchTerm.getText();
		    	        var params = new LzParam();
		        	    params.addValue('action', 'saveSearchTerm', true);
			            params.addValue('term', term);
		    	        saveSearch.setQueryString(params);
		        	    saveSearch.doRequest(); 	    				
    				</method>
				</mdn_button>										        	           	        	        	
	        </view>
			<view>
				<text id="msgKeywordSearchError" text="" fgcolor="red" fontstyle="bold" resize="true"/>
			</view>	        	        
	        <view>
		        <simplelayout axis="y" />
		        <text datapath="gui:/gui-labels/lbl-test-result/@label" fontstyle="bold" width="80" fgcolor="0x454545" />
		        <view width="525" height="1" bgcolor="0xe3e3e3" />
		        <view width="10" height="5" />
	        </view>
		    <view>
	        	<simplelayout axis="x"/>
	        	<text datapath="gui:/gui-labels/lbl-msg-type/@label" width="120" fgcolor="0x454545" />
				<radiogroup layout="axis: x; spacing:7"  id="messagingTypeRadioID" height="20">
					<radiobutton datapath="gui:/gui-labels/lbl-email2/@label" width="90" value="Email">
					<hinttip tipid="ENDUSERACCESS-msgquery-msgtest-email" /> </radiobutton>
					<radiobutton datapath="gui:/gui-labels/lbl-sms/@label" width="90" value="SMS" >
					<hinttip tipid="ENDUSERACCESS-msgquery-msgtest-sms" /> </radiobutton>										
					<radiobutton datapath="gui:/gui-labels/lbl-im/@label" width="90" value="IM" >
					<hinttip tipid="ENDUSERACCESS-msgquery-msgtest-im" /> </radiobutton>
				</radiogroup>
	        </view>
	        <view>
	        	<simplelayout axis="x"/>
	        	<text datapath="gui:/gui-labels/lbl-search-userinput/@label" width="120" fgcolor="0x454545" />
	        	<edittext id="searchUI" text="" width="150"/>
	        	<text text="" width="5" />
	        	<mdn_button datapath="gui:/gui-labels/btn-test/@label" width="50">
		        	<method event="onclick">		
	    				var ui = searchUI.getText();
	    				var type = messagingTypeRadioID.getValue();
		    	        var params = new LzParam();
		        	    params.addValue('action', 'testSearchTerm', true);
			            params.addValue('ui', ui);
			            params.addValue('type', type);
		    	        testSearch.setQueryString(params);
		        	    testSearch.doRequest(); 	    					        	
	     			</method>   		
	        	</mdn_button>
	        </view>	        
	        <view>
	        	<text text="" height="10" />
	        </view>	        
	        <!-- datapath="testSearch:/root/@result" -->
			<scrolledittext datapath="testSearch:/root/@result" id="searchTermResult" 
				fgcolor="0x5A5A5A" bgcolor="0xf9f9f9" 
				multiline="true"
				width="470" height="300">
            </scrolledittext> 

	    </view>            
   </class>     
   <!-- Add new Gateway smpp connection -->
   <class name="viewAddSmpp" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  
        <method name="clearData">
          	txtErrorSmppNew.setText('');
			smppNumberNew.setText('');
			smppHostNew.setText('');
			smppPortNew.setText('');
			smppUsernameNew.setText('');
			smppPasswordNew.setText('');																				
			smppNpiNew.setText('');
			smppTonNew.setText('');
			destNpiNew.setText('');
			destTonNew.setText('');			
			bindNpiNew.setText('');
			bindTonNew.setText('');						
			checkTimeIdNew.setText('');
			useTlvCbxNew.setAttribute('value', false);          	
			useAddrRangeCbxNew.setAttribute('value', false);          	
    	</method>
	    <view width="700" height="${immediateparent.height - 80}" x="40" y="10" >
	        <simplelayout axis="y" spacing="10"/>
	        <view>
	            <text datapath="gui:/gui-labels/lbl-smpp-info/@label"  width="450" multiline="true" fgcolor="0x454545" />     
	        </view>
	        <view>
		        <simplelayout axis="y" spacing="1"/>
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-number/@label" width="105" fgcolor="0x454545" />
					<edittext id="smppNumberNew" width="150"/>
					<text datapath="gui:/gui-labels/lbl-smpp-number-info/@label" width="250" fgcolor="gray"/>
		        </view>	        	        	        	        	        
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-host/@label" width="105" fgcolor="0x454545" />
					<edittext id="smppHostNew" width="150"/>
		        </view>
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-port/@label" width="105" fgcolor="0x454545" />
					<edittext id="smppPortNew" width="150" />
		        </view>	        
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-username/@label" width="105" fgcolor="0x454545" />
					<edittext id="smppUsernameNew" width="150"/>
		        </view>	        	        
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-password/@label" width="105" fgcolor="0x454545" />
					<edittext id="smppPasswordNew" width="150" password="true"/>
		        </view>
	        </view>	        	        	        
	        <view>
		        <simplelayout axis="y" spacing="1"/>
		        <view>
			        <simplelayout axis="y" />
			        <view width="525" height="1" bgcolor="0xe3e3e3" />
			        <text datapath="gui:/gui-labels/lbl-ton-npi-title/@label" fontstyle="bold" width="400" fgcolor="0x454545" />
		        </view>
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-ton/@label" width="105" fgcolor="0x454545" />
					<edittext id="smppTonNew" width="50" maxlength="1"/>
					<text text="" width="15" />
		            <text datapath="gui:/gui-labels/lbl-smpp-npi/@label" width="72" fgcolor="0x454545" />
					<edittext id="smppNpiNew" width="50" maxlength="1"/>
		        </view>
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-dest-ton/@label" width="105" fgcolor="0x454545" />
					<edittext id="destTonNew" width="50" maxlength="1"/>				
					<text text="" width="15" />
					<text datapath="gui:/gui-labels/lbl-dest-npi/@label" width="72" fgcolor="0x454545" />
					<edittext id="destNpiNew" width="50" maxlength="1"/>
		        </view>	 
	 	        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-bind-ton/@label" width="105" fgcolor="0x454545" />
					<edittext id="bindTonNew" width="50" maxlength="1"/>				
					<text text="" width="15" />
					<text datapath="gui:/gui-labels/lbl-bind-npi/@label" width="72" fgcolor="0x454545" />
					<edittext id="bindNpiNew" width="50" maxlength="1"/>
		        </view>
	        </view>	 	       
	        <view>
		        <view width="525" height="1" bgcolor="0xe3e3e3" />
	        </view>	               	    
	        <view>
		        <simplelayout axis="y"/>	        
				<ftcheckbox2 id="useAddrRangeCbxNew" labelXpath="gui:/gui-labels/lbl-use-addr-range/@label" />
				<ftcheckbox2 id="useTlvCbxNew" labelXpath="gui:/gui-labels/lbl-use-tlv/@label" />
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-check-activity/@label" width="118" fgcolor="0x454545" />
					<edittext id="checkTimeIdNew" width="35" maxlength="3"/>
					<text datapath="gui:/gui-labels/lbl-seconds/@label" width="55" fgcolor="0x454545" />
				</view>	
		        <view>
					<text datapath="gui:/gui-labels/lbl-check-info/@label" fgcolor="gray" width="360"/>	        
		        </view>								
	        </view>        	        
	        <view>
		        <mdn_button text="save" width="70" x="280">
	    	        <method event="onclick">
						var number = smppNumberNew.getText();
						var host = smppHostNew.getText();
						var port = smppPortNew.getText();
						var username = smppUsernameNew.getText();
						var password = smppPasswordNew.getText();																				
						var npi = smppNpiNew.getText();
						var ton = smppTonNew.getText();
						var destNpiTxt = destNpiNew.getText();
						var destTonTxt = destTonNew.getText();						
						var bindNpiTxt = bindNpiNew.getText();
						var bindTonTxt = bindTonNew.getText();						
						var checkTime = checkTimeIdNew.getText();
						var useTlv = useTlvCbxNew.getAttribute('value');
						var useAddrRange = useAddrRangeCbxNew.getAttribute('value');						
	    		        
	    		        var params = new LzParam();
	        		    params.addValue('action', 'saveSmpp', true);
	        		    params.addValue('id', -1);
	        		    params.addValue('number', number);
	        		    params.addValue('host', host);        		    
	        		    params.addValue('port', port);
	        		    params.addValue('username', username);
	        		    params.addValue('password', password);
	        		    params.addValue('npi', npi);
	        		    params.addValue('ton', ton);	   
	        		    params.addValue('destNpi', destNpiTxt);
	        		    params.addValue('destTon', destTonTxt);	   	        		    
	        		    params.addValue('bindNpi', bindNpiTxt);
	        		    params.addValue('bindTon', bindTonTxt);	   	        		    	        		    
	        		    params.addValue('checkTime', checkTime);
	        		    params.addValue('useTlv', useTlv);
	        		    params.addValue('useAddrRange', useAddrRange);	        		    	        		    
	
	    	    	    dbSmppSave.setQueryString(params);
	        	    	dbSmppSave.doRequest();
		            </method>
		            <hinttip tipid="GLOBALSETTINGS-sms-save" />
	        	</mdn_button>
	       </view>
	        <view height="5"/>
	        <view>
	            <text id="txtErrorSmppNew" datapath="dbSmppSave:/root/@result" fgcolor="red" fontstyle="bold" resize="true"  width="300" height="60" multiline="true" />
	        </view>
		</view> 
   </class>     
	<!-- Load new data after add/edit a smpp connection -->
	<datapointer xpath="dbSmppSave:/root" rerunxpath="true"
							ondata="processData();" onerror="canvas.showError(this);"
							ontimeout="canvas.showTimeout();">
		<method name="processData">
			Debug.write("received dbSmppSave return data");
			projectTabs.whereami.select(projectTabs.whereami.getAttribute("currselnode"));
			var response = this.getNodeAttribute('response');
			var isTreeChanged = this.getNodeAttribute('isTreeChanged');				
			if (response == 'OK'){// the save transaction is ok, Switch display screen
				var id = this.getNodeAttribute('id');
				controller.displaySmpp(id);							
			}
			if(isTreeChanged == 'true'){//sett navigator tree has been changed, refresh it!
				controller.getNavSett();			
			}
		</method>
	</datapointer>					   
   <class name="viewGatewaySmppSett" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" >  
        <method name="clearData">
          	txtErrorSmpp.setText('');
    	</method>
	    <view width="700" height="${immediateparent.height - 80}" x="40" y="10" >
	        <simplelayout axis="y" spacing="10"/>
	        <view>
	            <text datapath="gui:/gui-labels/lbl-smpp-info/@label"  width="450" multiline="true" fgcolor="0x454545"/>     
	        </view>
	        <view>
		        <simplelayout axis="y" spacing="1" />
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-number/@label" width="105" fgcolor="0x454545"/>
		            <text id="smppId" width="150" datapath="dbSmppSett:/root/@id" visible="false"/>
					<edittext id="smppNumber" width="150" datapath="dbSmppSett:/root/@number" />
					<text datapath="gui:/gui-labels/lbl-smpp-number-info/@label" width="250" fgcolor="gray"/>
		        </view>	        	        	        	        	        
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-host/@label" width="105" fgcolor="0x454545"/>
					<edittext id="smppHost" width="150" datapath="dbSmppSett:/root/@host">
			        	<method event="ondata">
				            var p = dbSmppSett.getPointer();
				            p.selectChild(1);
				            var tlvValue = p.p.getAttr('tlv');
				        	if(tlvValue == 'true'){
				        		useTlvCbx.setAttribute('value', true);
				        	}else{
					        	useTlvCbx.setAttribute('value', false);
				        	}
				        	
				            var useAddrRangeValue = p.p.getAttr('useAddrRange');
				        	if(useAddrRangeValue == 'true'){
				        		useAddrRangeCbx.setAttribute('value', true);
				        	}else{
					        	useAddrRangeCbx.setAttribute('value', false);
				        	}			        	
				        	
		    	    	</method>				
		    	    </edittext>	
		        </view>
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-port/@label" width="105" fgcolor="0x454545"/>
					<edittext id="smppPort" width="150" datapath="dbSmppSett:/root/@port" />
		        </view>	        
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-username/@label" width="105" fgcolor="0x454545"/>
					<edittext id="smppUsername" width="150" datapath="dbSmppSett:/root/@username" />
		        </view>	        	        
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-password/@label" width="105" fgcolor="0x454545"/>
					<edittext id="smppPassword" width="150" datapath="dbSmppSett:/root/@password" password="true"/>
		        </view>	 
	        </view>       	        	        
	        <view>
		        <simplelayout axis="y" spacing="1"/>
		        <view>
			        <simplelayout axis="y" />
			        <view width="525" height="1" bgcolor="0xe3e3e3" />
			        <text datapath="gui:/gui-labels/lbl-ton-npi-title/@label" fontstyle="bold" width="400" fgcolor="0x454545" />
		        </view>
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-smpp-ton/@label" width="105" fgcolor="0x454545"/>
					<edittext id="smppTon" width="50" datapath="dbSmppSett:/root/@ton" maxlength="1" />		        
			        <text text="" width="15" />				
		            <text datapath="gui:/gui-labels/lbl-smpp-npi/@label" width="72" fgcolor="0x454545"/>
					<edittext id="smppNpi" width="50" datapath="dbSmppSett:/root/@npi" maxlength="1"/>
		        </view>	        	        	        
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-dest-ton/@label" width="105" fgcolor="0x454545" />
					<edittext id="destTon" width="50" datapath="dbSmppSett:/root/@destTon" maxlength="1"/>								
					<text text="" width="15" />				
		            <text datapath="gui:/gui-labels/lbl-dest-npi/@label" width="72" fgcolor="0x454545" />
					<edittext id="destNpi" width="50" datapath="dbSmppSett:/root/@destNpi" maxlength="1"/>								
		        </view>	        	        	        
		        <view>
			        <simplelayout axis="x"/>
		            <text datapath="gui:/gui-labels/lbl-bind-ton/@label" width="105" fgcolor="0x454545" />
					<edittext id="bindTon" width="50" datapath="dbSmppSett:/root/@bindTon" maxlength="1"/>				
					<text text="" width="15" />
					<text datapath="gui:/gui-labels/lbl-bind-npi/@label" width="72" fgcolor="0x454545" />
					<edittext id="bindNpi" width="50" datapath="dbSmppSett:/root/@bindNpi" maxlength="1"/>
		        </view>	 	        
	        </view>
	        
	        <view>
		        <simplelayout axis="y" spacing="1"/>	        
		        <view>
			        <view width="525" height="1" bgcolor="0xe3e3e3" />
		        </view>
		        <view>
		        	<simplelayout axis="y" />
					<ftcheckbox2 id="useAddrRangeCbx" labelXpath="gui:/gui-labels/lbl-use-addr-range/@label" />	
					<ftcheckbox2 id="useTlvCbx" labelXpath="gui:/gui-labels/lbl-use-tlv/@label" /><!-- valueXpath="dbSmppSett:/root/@tlv"  -->
		        </view>        	        
		        <view>
			        <simplelayout axis="y"/>
			        <view>
				        <simplelayout axis="x"/>
			            <text datapath="gui:/gui-labels/lbl-check-activity/@label" width="118" fgcolor="0x454545"/>
						<edittext id="checkTimeId" width="35" datapath="dbSmppSett:/root/@checkTime" maxlength="3"/>
						<text datapath="gui:/gui-labels/lbl-seconds/@label" fgcolor="0x454545"/>
					</view>	
			        <view>
						<text datapath="gui:/gui-labels/lbl-check-info/@label" fgcolor="gray" width="360"/>	        
			        </view>				
		        </view>
	        </view>	        
	        <view>
		        <mdn_button text="save" width="70" x="280">
	    	        <method event="onclick">
		    	        var id = smppId.getText();
						var number = smppNumber.getText();
						var host = smppHost.getText();
						var port = smppPort.getText();
						var username = smppUsername.getText();
						var password = smppPassword.getText();																				
						var npi = smppNpi.getText();
						var ton = smppTon.getText();
						var destNpiTxt = destNpi.getText();
						var destTonTxt = destTon.getText();						
						var bindNpiTxt = bindNpi.getText();
						var bindTonTxt = bindTon.getText();												
						var checkTime = checkTimeId.getText();
						var useTlv = useTlvCbx.getAttribute('value');
						var useAddrRange = useAddrRangeCbx.getAttribute('value');
	    		        
	    		        var params = new LzParam();
	        		    params.addValue('action', 'saveSmpp', true);
	        		    params.addValue('id', id);
	        		    params.addValue('number', number);
	        		    params.addValue('host', host);        		    
	        		    params.addValue('port', port);
	        		    params.addValue('username', username);
	        		    params.addValue('password', password);
	        		    params.addValue('npi', npi);
	        		    params.addValue('ton', ton);	   
	        		    params.addValue('destNpi', destNpiTxt);
	        		    params.addValue('destTon', destTonTxt);	   
	        		    params.addValue('bindNpi', bindNpiTxt);
	        		    params.addValue('bindTon', bindTonTxt);	   
	        		    params.addValue('checkTime', checkTime);
	        		    params.addValue('useTlv', useTlv);	        		    
	        		    params.addValue('useAddrRange', useAddrRange);
	
	    	    	    dbSmppSave.setQueryString(params);
	        	    	dbSmppSave.doRequest();
		            </method>
		            <hinttip tipid="GLOBALSETTINGS-sms-save" />
	        	</mdn_button>
	       </view>
	        <view height="5"/>
	        <view>
	            <text id="txtErrorSmpp" datapath="dbSmppSave:/root/@result" fgcolor="red" fontstyle="bold" resize="true"  width="300" height="60" multiline="true" />
	        </view>
		</view> 
   </class>     	
   
   
   <class name="viewPubMsgLog" width="${navsett_rightView.width - 1}" 
        height="${navSettUpperPart.height - navSettHeader.height - 1}" extends="mdn_roundrect" x="0" y="0">  
        <method name="clearData">
          	txtErrorSmpp.setText('');
    	</method>
	     <view width="${immediateparent.width}" height="${immediateparent.height}" x="0" y="0"> 
	     	<simplelayout axis="y"/>
			<tabs width="${immediateparent.width}" height="505" tabspacing="1" bgcolor="0x4386cc">    
				<attribute name="tabclass" value="tabWhiteTab" type="string" />
				<method event="oninit">
					<![CDATA[
               			//Pushes the first tab in
						this.subviews[0].layouts[0].setAttribute("inset", 15);
					]]>
				</method>
				<tabpane  datapath="gui:/gui-labels/lbl-log-tab/@label" selected="true">
					<simplelayout axis="y"/>
					<view id="logGridView">
						<simplelayout axis="x"/>
						<ftdynamicgrid id="logGrid" datapath="dbPubMsgLog:/root" >
						    <ftgridtextcolumn width="220" datapath="@text">Text Message </ftgridtextcolumn>
						    <ftgridtextcolumn width="120" datapath="@from">From </ftgridtextcolumn>
						    <ftgridtextcolumn width="120" datapath="@to"> To</ftgridtextcolumn>						   
						    <ftgridtextcolumn width="120" datapath="@date"> Date &amp; Time</ftgridtextcolumn>						     
						</ftdynamicgrid>
						
	    				<!-- <ftdynamicgrid height="300" datapath="dbPubMsgLog:/root" >
						    <gridcolumn  width="150">Text Message
						    	<text datapath="@text" />
						    </gridcolumn >
						    <gridcolumn  width="150"> From
						    	<text datapath="@from" />							    
						    </gridcolumn >
						    <gridcolumn  width="150"> To
						    	<text datapath="@to" />							    
						    </gridcolumn >			
						    <gridcolumn  width="150"> Date &amp; Time
						    	<text datapath="@date" />							    
						    </gridcolumn >						    			    
						</ftdynamicgrid> -->
					</view>					
				</tabpane>
				<tabpane datapath="gui:/gui-labels/lbl-reporting-tab/@label">
					<simplelayout axis="y" spacing="5"/>
		        	<text datapath="dbPubMsgLog:/root/@smtpEncTypes" visible="false">
			        	<method event="ondata">
				            var p = dbEmail.getPointer();
				            p.selectChild(1);
				            var smtpEncTypeValue = p.p.getAttr('smtpEncType');        	
				            
				            smtpEncTypeLogs.selectItem(smtpEncTypeValue);
		    	    	</method>
		        	</text>        					
			        <view>
			            <simplelayout axis="x"/>
			            <text datapath="gui:/gui-labels/lbl-enc-type/@label" width="115" fgcolor="0x454545" />        
			            <combobox id="smtpEncTypeLogs" width="70" editable="false" bgcolor="${canvas.bgcolor}" shownitems="8">
			                 <textlistitem text="None" value="1" selected="true"/>
			                 <textlistitem text="SSL" value="2"/>                 
			                 <textlistitem text="TLS" value="3"/>                                  
			                 <textlistitem text="Auto" value="4"/>                                                   
			            </combobox>        
			        </view>        
			        <view name="smtp">
			            <simplelayout axis="x"/>
			            <text datapath="gui:/gui-labels/lbl-smtp-host/@label" width="115" fgcolor="0x454545" />
			            <edittext id="smtpHostTxtLogs" width="200" datapath="dbPubMsgLog:/root/@smtpHost" />
			            <hinttip tipid="GLOBALSETTINGS-email-smtp" />
			            <text text="" width="3"/>
			            <text datapath="gui:/gui-labels/lbl-port/@label" width="32" fgcolor="0x454545" />
			            <edittext id="smtpPortTxtLogs" width="45" text="25" maxlength="4" datapath="dbPubMsgLog:/root/@smtpPort"/>
			        </view>
			        <view name="smtpUser">
			            <simplelayout axis="x"/>
			            <text datapath="gui:/gui-labels/lbl-smtp-username/@label" width="115" fgcolor="0x454545"></text>
			            <edittext id="smtpUsernameTxtLogs" width="200" datapath="dbPubMsgLog:/root/@smtpUsername" />
			            <hinttip tipid="GLOBALSETTINGS-email-username" />
			        </view> 
			        <view name="smtpPassword">
			            <simplelayout axis="x"/>
			            <text datapath="gui:/gui-labels/lbl-smtp-password/@label" width="115" fgcolor="0x454545"></text>
			            <edittext id="smtpPasswordTxtLogs" password="true" width="200" datapath="dbPubMsgLog:/root/@smtpPassword"/>
			            <hinttip tipid="GLOBALSETTINGS-email-password" />
			        </view>
			        <view>
			        	<simplelayout axis="x"/> 
			        	<text datapath="gui:/gui-labels/lbl-send-email-interval/@label" width="115" fgcolor="0x454545" />
			            <edittext id="smtpPasswordTxtLogs" width="50" datapath="dbPubMsgLog:/root/@sendInterval" maxlength="2"/>
			        	<text datapath="gui:/gui-labels/lbl-days/@label" width="110" fgcolor="0x454545" />			            			        	
			        </view>					
				</tabpane>			
			</tabs>
	    </view>
	</class>       
</library>